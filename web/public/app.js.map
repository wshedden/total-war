{
  "version": 3,
  "sources": ["../src/util/dom.js", "../src/ui/layout.js", "../src/ui/topbar.js", "../src/ui/search.js", "../src/util/format.js", "../src/util/rng.js", "../src/state/relationships.js", "../src/state/relationEffects.js", "../src/state/diplomaticActions.js", "../src/state/influence.js", "../src/state/selectors.js", "../src/ui/dossier.js", "../src/ui/tooltip.js", "../src/state/metricRange.js", "../src/ui/overlays.js", "../src/ui/debug.js", "../src/ui/saveLoad.js", "../src/state/policies.js", "../src/state/store.js", "../src/state/actions.js", "../../node_modules/topojson-client/src/identity.js", "../../node_modules/topojson-client/src/transform.js", "../../node_modules/topojson-client/src/reverse.js", "../../node_modules/topojson-client/src/feature.js", "../../node_modules/d3-array/src/fsum.js", "../../node_modules/d3-array/src/merge.js", "../../node_modules/d3-geo/src/math.js", "../../node_modules/d3-geo/src/noop.js", "../../node_modules/d3-geo/src/stream.js", "../../node_modules/d3-geo/src/cartesian.js", "../../node_modules/d3-geo/src/compose.js", "../../node_modules/d3-geo/src/rotation.js", "../../node_modules/d3-geo/src/circle.js", "../../node_modules/d3-geo/src/clip/buffer.js", "../../node_modules/d3-geo/src/pointEqual.js", "../../node_modules/d3-geo/src/clip/rejoin.js", "../../node_modules/d3-geo/src/polygonContains.js", "../../node_modules/d3-geo/src/clip/index.js", "../../node_modules/d3-geo/src/clip/antimeridian.js", "../../node_modules/d3-geo/src/clip/circle.js", "../../node_modules/d3-geo/src/clip/line.js", "../../node_modules/d3-geo/src/clip/rectangle.js", "../../node_modules/d3-geo/src/identity.js", "../../node_modules/d3-geo/src/path/area.js", "../../node_modules/d3-geo/src/path/bounds.js", "../../node_modules/d3-geo/src/path/centroid.js", "../../node_modules/d3-geo/src/path/context.js", "../../node_modules/d3-geo/src/path/measure.js", "../../node_modules/d3-geo/src/path/string.js", "../../node_modules/d3-geo/src/path/index.js", "../../node_modules/d3-geo/src/transform.js", "../../node_modules/d3-geo/src/projection/fit.js", "../../node_modules/d3-geo/src/projection/resample.js", "../../node_modules/d3-geo/src/projection/index.js", "../../node_modules/d3-geo/src/projection/naturalEarth1.js", "../src/map/camera.js", "../src/map/projection.js", "../src/map/styles.js", "../src/map/picking.js", "../src/map/renderer.js", "../src/util/perf.js", "../src/main.js"],
  "sourcesContent": ["export const el = (tag, className, text) => {\n  const node = document.createElement(tag);\n  if (className) node.className = className;\n  if (text != null) node.textContent = text;\n  return node;\n};\n\nexport function isTypingTarget(target = document.activeElement) {\n  if (!target) return false;\n  const tag = target.tagName;\n  return tag === 'INPUT' || tag === 'TEXTAREA' || target.isContentEditable;\n}\n", "import { el } from '../util/dom.js';\n\nexport function buildLayout(root) {\n  const app = el('div', 'app');\n  const topbar = el('div', 'topbar');\n  const main = el('div', 'main');\n  const mapWrap = el('div', 'map-wrap');\n  const canvas = el('canvas');\n  canvas.id = 'mapCanvas';\n  const tooltip = el('div', 'tooltip');\n  tooltip.hidden = true;\n  const legend = el('div', 'legend');\n  legend.hidden = true;\n  const debug = el('div', 'debug');\n  debug.hidden = true;\n  const dossier = el('aside', 'dossier');\n\n  mapWrap.append(canvas, tooltip, legend, debug);\n  main.append(mapWrap, dossier);\n  app.append(topbar, main);\n  root.append(app);\n\n  return { app, topbar, main, mapWrap, canvas, tooltip, legend, debug, dossier };\n}\n", "import { el } from '../util/dom.js';\n\nexport function renderTopbar(container, actions) {\n  const search = el('input');\n  search.placeholder = 'Search country\u2026';\n  search.id = 'countrySearch';\n\n  const pause = el('button', '', 'Pause');\n  const step = el('button', '', 'Step');\n  const speed = el('select');\n  ['1','2','4'].forEach((s)=> {\n    const o = el('option'); o.value = s; o.textContent = `x${s}`; speed.append(o);\n  });\n\n  const overlay = el('select');\n  overlay.innerHTML = '<option value=\"political\">Political</option><option value=\"diplomacy\">Diplomacy</option><option value=\"heatmap\">Data Heatmap</option>';\n  const metric = el('select');\n  metric.innerHTML = '<option value=\"gdp\">GDP</option><option value=\"gdpPerCapita\">GDP per capita</option><option value=\"population\">Population</option><option value=\"militaryPercentGdp\">Military % GDP</option>';\n\n  const save = el('button', '', 'Save');\n  const load = el('button', '', 'Load');\n  const exportBtn = el('button', '', 'Export');\n  const importBtn = el('button', '', 'Import');\n  const newGame = el('button', '', 'New Game');\n  const help = el('button', '', 'Help');\n\n  pause.onclick = () => actions.togglePause();\n  step.onclick = () => actions.stepTurn();\n  speed.onchange = () => actions.setSpeed(Number(speed.value));\n  overlay.onchange = () => actions.setOverlay(overlay.value);\n  metric.onchange = () => actions.setMetric(metric.value);\n\n  container.append(search, pause, step, speed, overlay, metric, save, load, exportBtn, importBtn, newGame, help);\n  return { search, pause, step, speed, overlay, metric, save, load, exportBtn, importBtn, newGame, help };\n}\n", "export function wireSearch(input, countries, actions) {\n  input.addEventListener('input', () => actions.setSearch(input.value));\n  input.addEventListener('keydown', (event) => {\n    if (event.key !== 'Enter') return;\n    const q = input.value.trim().toLowerCase();\n    const match = countries.find((c) => c.name.toLowerCase().includes(q) || c.cca3.toLowerCase() === q);\n    if (match) actions.selectCountry(match.cca3);\n  });\n}\n", "const compact = new Intl.NumberFormat('en-GB', { notation: 'compact', maximumFractionDigits: 2 });\nconst num = new Intl.NumberFormat('en-GB', { maximumFractionDigits: 2 });\n\nexport const fmtCompact = (value) => (Number.isFinite(value) ? compact.format(value) : '\u2014');\nexport const fmtNumber = (value) => (Number.isFinite(value) ? num.format(value) : '\u2014');\nexport const fmtPercent = (value) => (Number.isFinite(value) ? `${num.format(value)}%` : '\u2014');\n", "export function hashString(input) {\n  let h = 2166136261 >>> 0;\n  for (let i = 0; i < input.length; i += 1) {\n    h ^= input.charCodeAt(i);\n    h = Math.imul(h, 16777619);\n  }\n  return h >>> 0;\n}\n\nexport function mulberry32(seed) {\n  let a = seed >>> 0;\n  return function rand() {\n    a += 0x6d2b79f5;\n    let t = a;\n    t = Math.imul(t ^ (t >>> 15), t | 1);\n    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);\n    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;\n  };\n}\n\nexport function countryTurnRng(globalSeed, turn, cca3, channel = 'base') {\n  const seed = hashString(`${globalSeed}:${turn}:${cca3}:${channel}`);\n  return mulberry32(seed);\n}\n\nexport function pairKey(a, b) {\n  return a < b ? `${a}|${b}` : `${b}|${a}`;\n}\n\nexport function rngPair(globalSeed, a, b, channel = 'pair') {\n  const seed = hashString(`${globalSeed}:${pairKey(a, b)}:${channel}`);\n  return mulberry32(seed);\n}\n", "import { hashString, mulberry32, pairKey } from '../util/rng.js';\n\nconst REL_MIN = -100;\nconst REL_MAX = 100;\nconst METER_MIN = 0;\nconst METER_MAX = 100;\n\nfunction clamp(value, min, max) {\n  return Math.max(min, Math.min(max, value));\n}\n\nfunction toSortedEdge(a, b) {\n  return a < b ? [a, b] : [b, a];\n}\n\nexport function edgeKey(a, b) {\n  const [x, y] = toSortedEdge(a, b);\n  return pairKey(x, y);\n}\n\nexport function createStableEdges(neighbours = {}) {\n  const edges = [];\n  for (const a of Object.keys(neighbours).sort()) {\n    for (const b of [...(neighbours[a] ?? [])].sort()) {\n      if (a < b) edges.push([a, b]);\n    }\n  }\n  edges.sort((x, y) => pairKey(x[0], x[1]).localeCompare(pairKey(y[0], y[1])));\n  return edges;\n}\n\nexport function getNeighbours(cca3, neighbours = {}) {\n  return neighbours?.[cca3] ?? [];\n}\n\nexport function getEdge(relations, a, b) {\n  const [x, y] = toSortedEdge(a, b);\n  return relations?.[x]?.[y] ?? null;\n}\n\nexport function setEdge(relations, a, b, edge) {\n  const [x, y] = toSortedEdge(a, b);\n  if (!relations[x]) relations[x] = {};\n  if (!relations[y]) relations[y] = {};\n  const frozen = {\n    rel: clamp(Math.round(edge.rel), REL_MIN, REL_MAX),\n    tension: clamp(Math.round(edge.tension), METER_MIN, METER_MAX),\n    trust: clamp(Math.round(edge.trust), METER_MIN, METER_MAX),\n    lastTurnUpdated: edge.lastTurnUpdated ?? 0,\n    modifiers: (edge.modifiers ?? []).map((m) => ({\n      rel: Math.round(m.rel ?? 0),\n      tension: Math.round(m.tension ?? 0),\n      trust: Math.round(m.trust ?? 0),\n      turns: Math.max(0, Math.round(m.turns ?? 0)),\n      text: m.text ?? ''\n    }))\n  };\n  relations[x][y] = frozen;\n  relations[y][x] = frozen;\n}\n\nexport function getSymmetricEdgeValue(edgeMap, a, b) {\n  return edgeMap?.[edgeKey(a, b)] ?? null;\n}\n\nexport function setSymmetricEdgeValue(edgeMap, a, b, value) {\n  const key = edgeKey(a, b);\n  if (value == null) {\n    delete edgeMap[key];\n    return;\n  }\n  edgeMap[key] = value;\n}\n\nfunction gaussianish(rng) {\n  return (rng() + rng() + rng()) / 3;\n}\n\nfunction withRegionBias(rel, a, b, countryIndex) {\n  const same = countryIndex?.[a]?.region && countryIndex?.[a]?.region === countryIndex?.[b]?.region;\n  return same ? rel + 5 : rel;\n}\n\nexport function initRelations(seed, neighbours, countryIndex) {\n  const relations = {};\n  const edges = createStableEdges(neighbours);\n\n  for (const [a, b] of edges) {\n    const rand = mulberry32(hashString(`pair:${seed}:${pairKey(a, b)}`));\n    const relNoise = Math.round((gaussianish(rand) - 0.5) * 60);\n    const rel = clamp(withRegionBias(relNoise, a, b, countryIndex), -30, 30);\n    const tension = 5 + Math.floor(rand() * 16);\n    const trust = 40 + Math.floor(rand() * 21);\n    setEdge(relations, a, b, { rel, tension, trust, lastTurnUpdated: 0, modifiers: [] });\n  }\n\n  return { relations, edges };\n}\n\nfunction edgeModifierTotals(edge) {\n  let rel = 0;\n  let tension = 0;\n  let trust = 0;\n  const nextModifiers = [];\n  for (const mod of edge.modifiers ?? []) {\n    rel += mod.rel ?? 0;\n    tension += mod.tension ?? 0;\n    trust += mod.trust ?? 0;\n    if ((mod.turns ?? 0) > 1) nextModifiers.push({ ...mod, turns: mod.turns - 1 });\n  }\n  return { rel, tension, trust, nextModifiers };\n}\n\nfunction classifyPosture(edge) {\n  if (edge.rel <= -40 || edge.tension >= 70) return 'Hostile';\n  if ((edge.rel >= -20 && edge.rel <= 39) || (edge.tension >= 40 && edge.tension <= 69)) return 'Wary';\n  return edge.rel >= 40 && edge.tension < 40 ? 'Friendly' : 'Wary';\n}\n\nexport function stepRelations({ turn, seed, relations, edges, dynamic, events, relationInputsByCountry = {} }) {\n  const nextRelations = {};\n  const postureByCountry = {};\n  const nextEvents = [];\n\n  const eventsByCountry = new Map();\n  for (const evt of events) {\n    if (!evt?.cca3) continue;\n    if (!eventsByCountry.has(evt.cca3)) eventsByCountry.set(evt.cca3, []);\n    eventsByCountry.get(evt.cca3).push(evt);\n  }\n\n  for (const [a, b] of edges) {\n    const prev = getEdge(relations, a, b) ?? { rel: 0, tension: 10, trust: 50, lastTurnUpdated: 0, modifiers: [] };\n    const powerA = dynamic[a]?.power ?? 0;\n    const powerB = dynamic[b]?.power ?? 0;\n    const denom = Math.max(powerA, powerB, 1);\n    const imbalance = (powerA - powerB) / denom;\n\n    const mod = edgeModifierTotals(prev);\n    let rel = prev.rel + clamp(Math.round((0 - prev.rel) * 0.02), -1, 1);\n    let tension = prev.tension;\n    let trust = prev.trust;\n\n    const hostileNear = (eventsByCountry.get(a) ?? []).some((e) => e.text?.toLowerCase().includes('shock'))\n      || (eventsByCountry.get(b) ?? []).some((e) => e.text?.toLowerCase().includes('shock'));\n\n    let tensionDelta = 0\n      + (rel < 0 ? 1 : -1)\n      + (Math.abs(imbalance) > 0.35 ? 1 : 0)\n      + (trust < 35 ? 1 : 0)\n      + (tension > 80 ? 1 : 0)\n      + (hostileNear ? 1 : 0);\n\n    let relDelta = 0\n      + (tension > 75 ? -1 : 0)\n      + (tension < 20 && trust > 60 ? 1 : 0);\n\n    let trustDelta = 0\n      + (rel > 25 && tension < 35 ? 1 : 0)\n      - (tension > 70 ? 1 : 0)\n      - (rel < -35 ? 1 : 0);\n\n    const inputA = relationInputsByCountry[a] ?? {};\n    const inputB = relationInputsByCountry[b] ?? {};\n    relDelta += (inputA.relDelta ?? 0) + (inputB.relDelta ?? 0);\n    tensionDelta += (inputA.tensionDelta ?? 0) + (inputB.tensionDelta ?? 0);\n    trustDelta += (inputA.trustDelta ?? 0) + (inputB.trustDelta ?? 0);\n\n    const pairRand = mulberry32(hashString(`evt:${seed}:${turn}:${pairKey(a, b)}`));\n    const roll = pairRand();\n    let evt = null;\n    if (roll < 0.0025) {\n      evt = { turn, cca3: a, secondary: b, text: 'Border Incident' };\n      rel -= 10;\n      tension += 15;\n      mod.nextModifiers.push({ rel: -1, tension: 2, trust: -1, turns: 3, text: 'Border Incident aftermath' });\n    } else if (roll < 0.005) {\n      evt = { turn, cca3: a, secondary: b, text: 'Trade Deal' };\n      rel += 10;\n      tension -= 10;\n      trust += 5;\n      mod.nextModifiers.push({ rel: 1, tension: -1, trust: 1, turns: 3, text: 'Trade momentum' });\n    } else if (roll < 0.007) {\n      evt = { turn, cca3: a, secondary: b, text: 'Sanctions' };\n      rel -= 15;\n      tension += 10;\n      mod.nextModifiers.push({ rel: -1, tension: 1, trust: -1, turns: 2, text: 'Sanctions pressure' });\n    } else if (roll < 0.009) {\n      evt = { turn, cca3: a, secondary: b, text: 'Joint Exercise' };\n      rel += 5;\n      trust += 10;\n      mod.nextModifiers.push({ rel: 1, tension: -1, trust: 1, turns: 3, text: 'Joint exercise confidence' });\n    }\n    if (evt) nextEvents.push(evt);\n\n    rel += relDelta + mod.rel;\n    tension += tensionDelta + mod.tension;\n    trust += trustDelta + mod.trust;\n\n    const edge = {\n      rel: clamp(rel, REL_MIN, REL_MAX),\n      tension: clamp(tension, METER_MIN, METER_MAX),\n      trust: clamp(trust, METER_MIN, METER_MAX),\n      lastTurnUpdated: turn,\n      modifiers: mod.nextModifiers\n    };\n\n    setEdge(nextRelations, a, b, edge);\n\n    const posture = classifyPosture(edge);\n    if (!postureByCountry[a]) postureByCountry[a] = {};\n    if (!postureByCountry[b]) postureByCountry[b] = {};\n    postureByCountry[a][b] = posture;\n    postureByCountry[b][a] = posture;\n  }\n\n  return { relations: nextRelations, postureByCountry, relationEvents: nextEvents };\n}\n\nexport function serializeRelations(edges, relations) {\n  const relationEdges = [];\n  for (const [a, b] of edges) {\n    const edge = getEdge(relations, a, b);\n    if (!edge) continue;\n    relationEdges.push([a, b, edge.rel, edge.tension, edge.trust, edge.modifiers ?? []]);\n  }\n  return relationEdges;\n}\n\nexport function hydrateRelations(neighbours, relationEdges = []) {\n  const relations = {};\n  const edges = createStableEdges(neighbours);\n  for (const row of relationEdges) {\n    const [a, b, rel, tension, trust, modifiers = []] = row;\n    if (!a || !b) continue;\n    setEdge(relations, a, b, { rel, tension, trust, modifiers, lastTurnUpdated: 0 });\n  }\n  return { relations, edges };\n}\n", "import { getSymmetricEdgeValue, setSymmetricEdgeValue } from './relationships.js';\n\nconst DEFAULT_STATE = Object.freeze({\n  guaranteesByEdge: {},\n  sanctionsByEdge: {},\n  tradeByEdge: {}\n});\n\nfunction cloneEdgeMap(edgeMap = {}) {\n  return { ...edgeMap };\n}\n\nfunction cloneContainer(state = {}) {\n  return {\n    guaranteesByEdge: cloneEdgeMap(state.guaranteesByEdge),\n    sanctionsByEdge: cloneEdgeMap(state.sanctionsByEdge),\n    tradeByEdge: cloneEdgeMap(state.tradeByEdge)\n  };\n}\n\nexport function createInitialRelationEffectsState() {\n  return cloneContainer(DEFAULT_STATE);\n}\n\nexport function hydrateRelationEffectsState(snapshotState = null) {\n  if (!snapshotState) return createInitialRelationEffectsState();\n  return {\n    guaranteesByEdge: cloneEdgeMap(snapshotState.guaranteesByEdge),\n    sanctionsByEdge: cloneEdgeMap(snapshotState.sanctionsByEdge),\n    tradeByEdge: cloneEdgeMap(snapshotState.tradeByEdge)\n  };\n}\n\nexport function addGuaranteeEffect(relationEffects, actor, target, expiryTurn) {\n  const list = Array.isArray(getSymmetricEdgeValue(relationEffects.guaranteesByEdge, actor, target))\n    ? [...getSymmetricEdgeValue(relationEffects.guaranteesByEdge, actor, target)]\n    : [];\n  const deduped = list.filter((item) => !(item?.actor === actor && item?.target === target));\n  deduped.push({ actor, target, expiryTurn: Math.max(0, Math.round(expiryTurn ?? 0)) });\n  setSymmetricEdgeValue(relationEffects.guaranteesByEdge, actor, target, deduped);\n}\n\nexport function addSanctionEffect(relationEffects, actor, target, expiryTurn, growthPenaltyActor, growthPenaltyTarget) {\n  const list = Array.isArray(getSymmetricEdgeValue(relationEffects.sanctionsByEdge, actor, target))\n    ? [...getSymmetricEdgeValue(relationEffects.sanctionsByEdge, actor, target)]\n    : [];\n  list.push({\n    actor,\n    target,\n    expiryTurn: Math.max(0, Math.round(expiryTurn ?? 0)),\n    growthPenaltyActor: growthPenaltyActor ?? 0,\n    growthPenaltyTarget: growthPenaltyTarget ?? 0\n  });\n  setSymmetricEdgeValue(relationEffects.sanctionsByEdge, actor, target, list);\n}\n\nexport function updateTradeEffect(relationEffects, a, b, update = {}) {\n  const prev = getSymmetricEdgeValue(relationEffects.tradeByEdge, a, b) ?? {};\n  const next = {\n    ...(typeof update.level === 'number' ? { level: Math.max(0, Math.round(update.level)) } : (typeof prev.level === 'number' ? { level: prev.level } : {})),\n    ...(typeof update.buffExpiryTurn === 'number'\n      ? { buffExpiryTurn: Math.max(0, Math.round(update.buffExpiryTurn)) }\n      : (typeof prev.buffExpiryTurn === 'number' ? { buffExpiryTurn: prev.buffExpiryTurn } : {}))\n  };\n\n  if (next.level == null && next.buffExpiryTurn == null) {\n    setSymmetricEdgeValue(relationEffects.tradeByEdge, a, b, null);\n    return;\n  }\n  setSymmetricEdgeValue(relationEffects.tradeByEdge, a, b, next);\n}\n\nexport function runRelationEffectsStage(relationEffects, turn) {\n  const next = cloneContainer(relationEffects);\n  const growthDeltaByCountry = {};\n\n  for (const [edge, guarantees] of Object.entries(next.guaranteesByEdge)) {\n    const active = (guarantees ?? []).filter((item) => (item?.expiryTurn ?? 0) > turn);\n    if (!active.length) delete next.guaranteesByEdge[edge];\n    else next.guaranteesByEdge[edge] = active;\n  }\n\n  for (const [edge, sanctions] of Object.entries(next.sanctionsByEdge)) {\n    const active = (sanctions ?? []).filter((item) => (item?.expiryTurn ?? 0) > turn);\n    if (!active.length) {\n      delete next.sanctionsByEdge[edge];\n      continue;\n    }\n    next.sanctionsByEdge[edge] = active;\n\n    for (const sanction of active) {\n      if (sanction.actor) {\n        growthDeltaByCountry[sanction.actor] = (growthDeltaByCountry[sanction.actor] ?? 0) + (sanction.growthPenaltyActor ?? 0);\n      }\n      if (sanction.target) {\n        growthDeltaByCountry[sanction.target] = (growthDeltaByCountry[sanction.target] ?? 0) + (sanction.growthPenaltyTarget ?? 0);\n      }\n    }\n  }\n\n  for (const [edge, trade] of Object.entries(next.tradeByEdge)) {\n    const level = typeof trade?.level === 'number' ? trade.level : null;\n    const buffExpiryTurn = typeof trade?.buffExpiryTurn === 'number' ? trade.buffExpiryTurn : null;\n    const hasActiveBuff = buffExpiryTurn != null && buffExpiryTurn > turn;\n\n    if (level == null && !hasActiveBuff) {\n      delete next.tradeByEdge[edge];\n      continue;\n    }\n\n    next.tradeByEdge[edge] = {\n      ...(level == null ? {} : { level }),\n      ...(hasActiveBuff ? { buffExpiryTurn } : {})\n    };\n\n    if (!hasActiveBuff) continue;\n    const [a, b] = edge.split('|');\n    growthDeltaByCountry[a] = (growthDeltaByCountry[a] ?? 0) + 0.002;\n    growthDeltaByCountry[b] = (growthDeltaByCountry[b] ?? 0) + 0.002;\n  }\n\n  return { relationEffects: next, growthDeltaByCountry };\n}\n", "import { getEdge, setEdge, getSymmetricEdgeValue } from './relationships.js';\nimport { addGuaranteeEffect, addSanctionEffect, hydrateRelationEffectsState, updateTradeEffect } from './relationEffects.js';\n\nconst MAX_INFLUENCE = 100;\n\nfunction clamp(value, min, max) {\n  return Math.max(min, Math.min(max, value));\n}\n\nfunction decrementCooldowns(cooldowns = {}) {\n  return Object.fromEntries(\n    Object.entries(cooldowns)\n      .map(([action, turns]) => [action, Math.max(0, (turns ?? 0) - 1)])\n      .filter(([, turns]) => turns > 0)\n  );\n}\n\nfunction relationCheck(edge) {\n  if (!edge) return { ok: false, reason: 'countries-are-not-neighbours' };\n  return { ok: true };\n}\n\nexport const ACTION_DEFINITIONS = Object.freeze({\n  improveRelations: {\n    type: 'improveRelations',\n    cost: 5,\n    cooldown: 2,\n    priority: 2,\n    check(state, actor, target) {\n      const edge = getEdge(state.relations, actor, target);\n      const link = relationCheck(edge);\n      if (!link.ok) return link;\n      if (edge.rel >= 85) return { ok: false, reason: 'relations-already-high' };\n      return { ok: true };\n    },\n    apply(edge) {\n      return {\n        rel: edge.rel + 10,\n        tension: edge.tension - 7,\n        trust: edge.trust + 6,\n        modifier: { rel: 1, tension: -1, trust: 1, turns: 2, text: 'Goodwill outreach' }\n      };\n    },\n    score(edge) {\n      return (70 - edge.rel) + edge.tension * 0.2;\n    }\n  },\n  offerTradeDeal: {\n    type: 'offerTradeDeal',\n    cost: 8,\n    cooldown: 3,\n    priority: 1,\n    check(state, actor, target) {\n      const edge = getEdge(state.relations, actor, target);\n      const link = relationCheck(edge);\n      if (!link.ok) return link;\n      if (edge.rel < -20) return { ok: false, reason: 'relations-too-poor-for-trade' };\n      if (edge.tension > 75) return { ok: false, reason: 'tension-too-high-for-trade' };\n      return { ok: true };\n    },\n    apply(edge) {\n      return {\n        rel: edge.rel + 14,\n        tension: edge.tension - 10,\n        trust: edge.trust + 8,\n        modifier: { rel: 2, tension: -1, trust: 1, turns: 3, text: 'Trade pact momentum' }\n      };\n    },\n    score(edge) {\n      return edge.rel + (100 - edge.tension) * 0.4 + edge.trust * 0.3;\n    }\n  },\n  threaten: {\n    type: 'threaten',\n    cost: 7,\n    cooldown: 2,\n    priority: 3,\n    check(state, actor, target) {\n      const edge = getEdge(state.relations, actor, target);\n      const link = relationCheck(edge);\n      if (!link.ok) return link;\n      const actorPower = state.dynamic?.[actor]?.power ?? 0;\n      const targetPower = state.dynamic?.[target]?.power ?? 0;\n      if (actorPower < targetPower * 0.9) return { ok: false, reason: 'insufficient-power-to-threaten' };\n      return { ok: true };\n    },\n    apply(edge) {\n      return {\n        rel: edge.rel - 12,\n        tension: edge.tension + 14,\n        trust: edge.trust - 10,\n        modifier: { rel: -1, tension: 2, trust: -1, turns: 2, text: 'Threat posture' }\n      };\n    },\n    score(edge) {\n      return (50 - edge.rel) + edge.tension;\n    }\n  },\n  guarantee: {\n    type: 'guarantee',\n    cost: 10,\n    cooldown: 4,\n    priority: 0,\n    check(state, actor, target) {\n      const edge = getEdge(state.relations, actor, target);\n      const link = relationCheck(edge);\n      if (!link.ok) return link;\n      if (edge.rel < 20) return { ok: false, reason: 'relations-too-low-to-guarantee' };\n      if (edge.trust < 35) return { ok: false, reason: 'trust-too-low-to-guarantee' };\n      const existing = getSymmetricEdgeValue(state.relationEffects?.guaranteesByEdge, actor, target) ?? [];\n      if (existing.some((item) => item?.actor === actor && item?.target === target && (item?.expiryTurn ?? 0) > state.turn)) {\n        return { ok: false, reason: 'guarantee-already-active' };\n      }\n      return { ok: true };\n    },\n    apply(edge) {\n      return {\n        rel: edge.rel + 8,\n        tension: edge.tension - 8,\n        trust: edge.trust + 12,\n        modifier: { rel: 1, tension: -2, trust: 2, turns: 4, text: 'Security guarantee pact' }\n      };\n    },\n    score(edge) {\n      return edge.rel * 0.7 + edge.trust - edge.tension * 0.5;\n    }\n  },\n  sanction: {\n    type: 'sanction',\n    cost: 9,\n    cooldown: 3,\n    priority: 4,\n    check(state, actor, target) {\n      const edge = getEdge(state.relations, actor, target);\n      const link = relationCheck(edge);\n      if (!link.ok) return link;\n      if (edge.rel > 35) return { ok: false, reason: 'relations-not-bad-enough-for-sanctions' };\n      return { ok: true };\n    },\n    apply(edge) {\n      return {\n        rel: edge.rel - 15,\n        tension: edge.tension + 9,\n        trust: edge.trust - 12,\n        modifier: { rel: -2, tension: 1, trust: -1, turns: 3, text: 'Sanctions regime' }\n      };\n    },\n    score(edge) {\n      return (0 - edge.rel) + edge.tension * 0.6;\n    }\n  }\n});\n\nexport function checkActionPreconditions(state, action) {\n  if (!action?.actor || !action?.target || !action?.type) return { ok: false, reason: 'malformed-action' };\n  if (action.actor === action.target) return { ok: false, reason: 'self-targeting-not-allowed' };\n  const actorEntry = state.dynamic?.[action.actor];\n  const targetEntry = state.dynamic?.[action.target];\n  if (!actorEntry) return { ok: false, reason: 'unknown-actor-country' };\n  if (!targetEntry) return { ok: false, reason: 'unknown-target-country' };\n\n  const def = ACTION_DEFINITIONS[action.type];\n  if (!def) return { ok: false, reason: 'unknown-action-type' };\n  if (actorEntry.actionUsedTurn === state.turn) return { ok: false, reason: 'actor-already-used-action-this-turn' };\n  if ((actorEntry.cooldowns?.[action.type] ?? 0) > 0) return { ok: false, reason: 'action-on-cooldown' };\n  if ((actorEntry.influence ?? 0) < def.cost) return { ok: false, reason: 'insufficient-influence' };\n\n  return def.check(state, action.actor, action.target);\n}\n\nfunction stableActionSort(a, b) {\n  if (a.priority !== b.priority) return a.priority - b.priority;\n  if (a.actor !== b.actor) return a.actor.localeCompare(b.actor);\n  if (a.target !== b.target) return a.target.localeCompare(b.target);\n  return a.type.localeCompare(b.type);\n}\n\nfunction getQueuedPlayerAction(state) {\n  return state.queuedPlayerAction ?? state.playerQueuedAction ?? state.queuedAction ?? null;\n}\n\nfunction getActionCandidatesForActor(state, actor) {\n  const relationTargets = Object.keys(state.relations?.[actor] ?? {}).filter((target) => target !== actor).sort();\n  const candidates = [];\n\n  for (const target of relationTargets) {\n    const edge = getEdge(state.relations, actor, target);\n    if (!edge) continue;\n    for (const [type, def] of Object.entries(ACTION_DEFINITIONS)) {\n      const candidate = { actor, target, type, source: 'ai', priority: def.priority };\n      const check = checkActionPreconditions(state, candidate);\n      if (!check.ok) continue;\n      candidates.push({ ...candidate, score: def.score(edge) });\n    }\n  }\n\n  candidates.sort((a, b) => {\n    if (a.score !== b.score) return b.score - a.score;\n    if (a.target !== b.target) return a.target.localeCompare(b.target);\n    return a.type.localeCompare(b.type);\n  });\n\n  return candidates;\n}\n\nexport function planActions(state) {\n  const plannedActions = [];\n  const queued = getQueuedPlayerAction(state);\n\n  if (queued) {\n    const def = ACTION_DEFINITIONS[queued.type];\n    plannedActions.push({\n      actor: queued.actor,\n      target: queued.target,\n      type: queued.type,\n      source: 'player',\n      priority: def?.priority ?? Number.MAX_SAFE_INTEGER\n    });\n  }\n\n  const blockedActors = new Set(plannedActions.map((item) => item.actor));\n  const actorCodes = Object.keys(state.dynamic ?? {}).sort();\n  for (const actor of actorCodes) {\n    if (blockedActors.has(actor)) continue;\n    const candidates = getActionCandidatesForActor(state, actor);\n    if (!candidates.length) continue;\n    plannedActions.push(candidates[0]);\n  }\n\n  return plannedActions.map(({ score, ...action }) => action);\n}\n\nexport function applyPlannedActions(state, plannedActions = []) {\n  const nextDynamic = {};\n  const nextRelationEffects = hydrateRelationEffectsState(state.relationEffects);\n  for (const [cca3, entry] of Object.entries(state.dynamic ?? {})) {\n    nextDynamic[cca3] = {\n      ...entry,\n      cooldowns: decrementCooldowns(entry.cooldowns)\n    };\n  }\n\n  const nextRelations = {};\n  for (const [a, neighbours] of Object.entries(state.relations ?? {})) {\n    if (!nextRelations[a]) nextRelations[a] = {};\n    for (const [b, edge] of Object.entries(neighbours ?? {})) {\n      nextRelations[a][b] = {\n        ...edge,\n        modifiers: [...(edge.modifiers ?? [])]\n      };\n    }\n  }\n\n  const actionEvents = [];\n  const sorted = [...plannedActions].sort(stableActionSort);\n\n  for (const action of sorted) {\n    const check = checkActionPreconditions({ ...state, dynamic: nextDynamic, relations: nextRelations }, action);\n    if (!check.ok) {\n      actionEvents.push({ turn: state.turn, cca3: action.actor, secondary: action.target, text: `Action failed (${action.type}): ${check.reason}` });\n      continue;\n    }\n\n    const def = ACTION_DEFINITIONS[action.type];\n    const edge = getEdge(nextRelations, action.actor, action.target);\n    const effect = def.apply(edge, action);\n    const updatedEdge = {\n      ...edge,\n      rel: clamp(effect.rel, -100, 100),\n      tension: clamp(effect.tension, 0, 100),\n      trust: clamp(effect.trust, 0, 100),\n      lastTurnUpdated: state.turn,\n      modifiers: [...(edge.modifiers ?? []), effect.modifier].filter((mod) => (mod?.turns ?? 0) > 0)\n    };\n\n    setEdge(nextRelations, action.actor, action.target, updatedEdge);\n\n    if (action.type === 'guarantee') {\n      addGuaranteeEffect(nextRelationEffects, action.actor, action.target, state.turn + 8);\n    }\n    if (action.type === 'sanction') {\n      addSanctionEffect(nextRelationEffects, action.actor, action.target, state.turn + 6, -0.0015, -0.006);\n    }\n    if (action.type === 'offerTradeDeal') {\n      const tradeState = getSymmetricEdgeValue(nextRelationEffects.tradeByEdge, action.actor, action.target) ?? {};\n      const level = Math.min(5, (tradeState.level ?? 0) + 1);\n      updateTradeEffect(nextRelationEffects, action.actor, action.target, {\n        level,\n        buffExpiryTurn: state.turn + 5\n      });\n    }\n\n    const actorEntry = nextDynamic[action.actor];\n    actorEntry.influence = clamp((actorEntry.influence ?? 0) - def.cost, 0, MAX_INFLUENCE);\n    actorEntry.actionUsedTurn = state.turn;\n    actorEntry.cooldowns = {\n      ...actorEntry.cooldowns,\n      [action.type]: def.cooldown\n    };\n\n    actionEvents.push({\n      turn: state.turn,\n      cca3: action.actor,\n      secondary: action.target,\n      text: `${action.source === 'player' ? 'Player' : 'AI'} ${action.type}`\n    });\n  }\n\n  return {\n    dynamic: nextDynamic,\n    relations: nextRelations,\n    events: actionEvents,\n    relationEffects: nextRelationEffects\n  };\n}\n", "export const TURN_INFLUENCE_CONFIG = {\n  baseGain: 1,\n  stabilityGain: 1,\n  topGdpGain: 1,\n  stabilityThreshold: 0.7,\n  topGdpPercentile: 0.15,\n  maxInfluence: 50\n};\n\nexport function rankCountriesByGdp(dynamic) {\n  return Object.entries(dynamic)\n    .map(([cca3, entry]) => ({ cca3, gdp: entry?.gdp ?? 0 }))\n    .sort((a, b) => (b.gdp - a.gdp) || a.cca3.localeCompare(b.cca3));\n}\n\nexport function buildTopGdpCountrySet(dynamic, percentile = TURN_INFLUENCE_CONFIG.topGdpPercentile) {\n  const ranking = rankCountriesByGdp(dynamic);\n  const count = Math.max(1, Math.ceil(ranking.length * percentile));\n  return new Set(ranking.slice(0, count).map((item) => item.cca3));\n}\n\nexport function computeInfluenceGain(entry, isTopGdpCountry, config = TURN_INFLUENCE_CONFIG) {\n  let gain = config.baseGain;\n  if ((entry?.stability ?? 0) >= config.stabilityThreshold) gain += config.stabilityGain;\n  if (isTopGdpCountry) gain += config.topGdpGain;\n  return gain;\n}\n\nexport function applyInfluenceGain(entry, gain, maxInfluence = TURN_INFLUENCE_CONFIG.maxInfluence) {\n  const influence = Math.max(0, entry?.influence ?? 0);\n  return Math.min(maxInfluence, influence + gain);\n}\n\n", "import { TURN_INFLUENCE_CONFIG, buildTopGdpCountrySet, computeInfluenceGain, applyInfluenceGain } from './influence.js';\n\nexport function selectNextTurnGainHint(state, cca3, config = TURN_INFLUENCE_CONFIG) {\n  const entry = state?.dynamic?.[cca3];\n  if (!entry) return null;\n\n  const topGdpCountries = buildTopGdpCountrySet(state.dynamic, config.topGdpPercentile);\n  const inTopGdpPercentile = topGdpCountries.has(cca3);\n  const gain = computeInfluenceGain(entry, inTopGdpPercentile, config);\n  const nextInfluence = applyInfluenceGain(entry, gain, config.maxInfluence);\n\n  return {\n    gain,\n    nextInfluence,\n    maxInfluence: config.maxInfluence,\n    reasons: {\n      base: true,\n      stability: (entry.stability ?? 0) >= config.stabilityThreshold,\n      topGdpPercentile: inTopGdpPercentile\n    }\n  };\n}\n\n", "import { fmtCompact, fmtPercent } from '../util/format.js';\nimport { ACTION_DEFINITIONS, checkActionPreconditions } from '../state/diplomaticActions.js';\nimport { selectNextTurnGainHint } from '../state/selectors.js';\n\nconst STANCE_OPTIONS = [\n  { value: 'conciliatory', label: 'Conciliatory' },\n  { value: 'neutral', label: 'Neutral' },\n  { value: 'hardline', label: 'Hardline' }\n];\n\nfunction relLabel(rel, tension) {\n  if (rel <= -40 || tension >= 70) return 'Hostile';\n  if ((rel >= -20 && rel <= 39) || (tension >= 40 && tension <= 69)) return 'Wary';\n  return rel >= 40 && tension < 40 ? 'Friendly' : 'Wary';\n}\n\nfunction relBar(rel) {\n  const pct = ((rel + 100) / 200) * 100;\n  return `<div class=\"rel-bar\" title=\"Relationship -100 to 100\"><i style=\"width:${pct.toFixed(1)}%\"></i></div>`;\n}\n\nfunction tensionBar(tension) {\n  return `<div class=\"tense-bar\" title=\"Border tension 0 to 100\"><i style=\"width:${tension}%\"></i></div>`;\n}\n\nfunction trustBar(trust) {\n  return `<div class=\"trust-bar\" title=\"Trust 0 to 100\"><i style=\"width:${trust}%\"></i></div>`;\n}\n\nconst NEIGHBOUR_SORT_MODES = [\n  { value: 'worst-relationship', label: 'worst relationship' },\n  { value: 'highest-tension', label: 'highest tension' },\n  { value: 'alphabetical', label: 'alphabetical' }\n];\n\nfunction sortNeighbours(selected, state, mode) {\n  const items = (state.neighbours?.[selected.cca3] ?? []).map((code) => {\n    const edge = state.relations?.[selected.cca3]?.[code] ?? { rel: 0, tension: 0, trust: 50 };\n    return {\n      code,\n      name: state.countryIndex?.[code]?.name ?? code,\n      rel: edge.rel,\n      tension: edge.tension,\n      trust: edge.trust,\n      powerRatio: (state.dynamic?.[selected.cca3]?.power ?? 0) / Math.max(1, state.dynamic?.[code]?.power ?? 0)\n    };\n  });\n  if (mode === 'alphabetical') items.sort((a, b) => a.name.localeCompare(b.name));\n  else if (mode === 'highest-tension') items.sort((a, b) => b.tension - a.tension || a.rel - b.rel || a.name.localeCompare(b.name));\n  else items.sort((a, b) => a.rel - b.rel || b.tension - a.tension || a.name.localeCompare(b.name));\n  return items;\n}\n\nfunction formatInfluenceHint(influenceHint) {\n  if (!influenceHint) return 'N/A';\n  const reasons = [];\n  if (influenceHint.reasons.base) reasons.push('base');\n  if (influenceHint.reasons.stability) reasons.push('stability');\n  if (influenceHint.reasons.topGdpPercentile) reasons.push('top GDP');\n  return `+${influenceHint.gain} next turn (${reasons.join(', ') || 'none'})`;\n}\n\nfunction reasonLabel(reason, cooldownTurns = 0, influence = 0, cost = 0) {\n  if (reason === 'actor-already-used-action-this-turn') return 'Action already used this turn.';\n  if (reason === 'insufficient-influence') return `Need ${cost} influence, have ${influence}.`;\n  if (reason === 'action-on-cooldown') return `On cooldown (${cooldownTurns} turn${cooldownTurns === 1 ? '' : 's'} remaining).`;\n  if (!reason) return '';\n  return `Precondition failed: ${reason.replaceAll('-', ' ')}.`;\n}\n\nfunction getActionUiState(state, actor, target, type) {\n  const cooldownTurns = state.dynamic?.[actor]?.cooldowns?.[type] ?? 0;\n  const queued = state.queuedPlayerAction;\n  if (queued && queued.actor === actor && queued.target === target && queued.type === type) {\n    return { disabled: true, reason: 'actor-already-used-action-this-turn', cooldownTurns, queued: true };\n  }\n\n  const check = checkActionPreconditions(state, { actor, target, type, source: 'player' });\n  return {\n    disabled: !check.ok,\n    reason: check.reason,\n    cooldownTurns,\n    queued: false\n  };\n}\n\nexport function renderDossier(node, state, actions, onUiStateChange = null) {\n  const selected = state.selected ? state.countryIndex[state.selected] : null;\n  if (!selected) {\n    const markup = '<h2>Country dossier</h2><p>Select a country to inspect key indicators.</p>';\n    if (node.__lastMarkup !== markup) {\n      node.innerHTML = markup;\n      node.__lastMarkup = markup;\n    }\n    return;\n  }\n\n  if (!node.__sortMode) node.__sortMode = 'worst-relationship';\n  const neighbours = sortNeighbours(selected, state, node.__sortMode);\n\n  const dyn = state.dynamic[selected.cca3];\n  const influenceHint = selectNextTurnGainHint(state, selected.cca3);\n  const influenceHintText = formatInfluenceHint(influenceHint);\n  const policy = dyn.policy ?? {};\n  const activeNeighbour = neighbours.find((item) => item.code === node.__diplomacyTarget) ?? neighbours[0] ?? null;\n  if (activeNeighbour) node.__diplomacyTarget = activeNeighbour.code;\n\n  const diplomaticButtons = activeNeighbour\n    ? Object.values(ACTION_DEFINITIONS).map((definition) => {\n      const uiState = getActionUiState(state, selected.cca3, activeNeighbour.code, definition.type);\n      const disabledReason = reasonLabel(uiState.reason, uiState.cooldownTurns, dyn.influence, definition.cost);\n      return `\n        <div class=\"dip-action-row\">\n          <button\n            class=\"dip-action\"\n            type=\"button\"\n            data-action-type=\"${definition.type}\"\n            ${uiState.disabled ? 'disabled' : ''}\n            title=\"Influence cost: ${definition.cost}\"\n          >\n            ${definition.type}${uiState.queued ? ' (Queued)' : ''}\n            <span class=\"dip-cost\">-${definition.cost} inf</span>\n          </button>\n          <div class=\"dip-action-meta\">\n            ${uiState.cooldownTurns > 0 ? `<span class=\"dip-cooldown\">Cooldown: ${uiState.cooldownTurns}t</span>` : '<span class=\"dip-cooldown dip-cooldown-ready\">Ready</span>'}\n            ${uiState.disabled ? `<span class=\"dip-disabled-reason\">${disabledReason}</span>` : '<span class=\"dip-disabled-reason dip-disabled-reason-ready\">Available this turn.</span>'}\n          </div>\n        </div>\n      `;\n    }).join('')\n    : '<div class=\"events\">No land neighbours in this dataset.</div>';\n\n  const markup = `\n    <h2>${selected.name}</h2>\n    <p>${selected.officialName}</p>\n    <div class=\"metric\"><span>Turn</span><strong data-dossier-turn>${state.turn}</strong></div>\n    <div class=\"metric\"><span>Code</span><strong>${selected.cca3}</strong></div>\n    <div class=\"metric\"><span>Region</span><strong>${selected.region}</strong></div>\n    <div class=\"metric\"><span>Population</span><strong>${fmtCompact(selected.population)}</strong></div>\n    <div class=\"metric\"><span>GDP (sim)</span><strong>${fmtCompact(dyn.gdp)}</strong></div>\n    <div class=\"metric\"><span>Military % GDP</span><strong>${fmtPercent(dyn.militaryPct)}</strong></div>\n    <div class=\"metric\"><span>Stability</span><strong>${fmtPercent(dyn.stability)}</strong></div>\n    <div class=\"metric\"><span>Influence</span><strong>${fmtCompact(dyn.influence)}</strong></div>\n    <div class=\"metric\" title=\"Projected influence gain next turn.\"><span>Influence gain hint</span><strong>${influenceHintText}</strong></div>\n    <div class=\"metric\"><span>Power</span><strong>${fmtCompact(dyn.power)}</strong></div>\n\n    <h3>Policy controls</h3>\n    <div class=\"policy-controls\">\n      <div class=\"policy-row\">\n        <label for=\"policy-military\">Military target (% GDP)</label>\n        <div class=\"policy-stepper\">\n          <button class=\"policy-step\" type=\"button\" data-policy-step=\"-0.01\">\u2212</button>\n          <input id=\"policy-military\" class=\"policy-input policy-range\" type=\"range\" min=\"0.5\" max=\"0.83\" step=\"0.01\" value=\"${policy.milTargetPct ?? 0.6}\" data-policy-field=\"milTargetPct\" />\n          <button class=\"policy-step\" type=\"button\" data-policy-step=\"0.01\">+</button>\n          <input class=\"policy-input policy-number\" type=\"number\" min=\"0.5\" max=\"0.83\" step=\"0.01\" value=\"${policy.milTargetPct ?? 0.6}\" data-policy-field=\"milTargetPct\" />\n        </div>\n      </div>\n      <div class=\"policy-row\">\n        <label for=\"policy-growth\">Growth focus (${policy.growthFocus ?? 50})</label>\n        <input id=\"policy-growth\" class=\"policy-input policy-range\" type=\"range\" min=\"0\" max=\"100\" step=\"1\" value=\"${policy.growthFocus ?? 50}\" data-policy-field=\"growthFocus\" />\n      </div>\n      <div class=\"policy-row\">\n        <label for=\"policy-stability\">Stability focus (${policy.stabilityFocus ?? 50})</label>\n        <input id=\"policy-stability\" class=\"policy-input policy-range\" type=\"range\" min=\"0\" max=\"100\" step=\"1\" value=\"${policy.stabilityFocus ?? 50}\" data-policy-field=\"stabilityFocus\" />\n      </div>\n      <div class=\"policy-row\">\n        <label for=\"policy-stance\">Stance</label>\n        <select id=\"policy-stance\" class=\"policy-input\" data-policy-field=\"stance\">\n          ${STANCE_OPTIONS.map((item) => `<option value=\"${item.value}\" ${policy.stance === item.value ? 'selected' : ''}>${item.label}</option>`).join('')}\n        </select>\n      </div>\n    </div>\n\n    <h3>Diplomatic actions</h3>\n    <div class=\"dip-targets\">\n      ${neighbours.map((item) => `<button type=\"button\" class=\"dip-target ${activeNeighbour?.code === item.code ? 'active' : ''}\" data-target=\"${item.code}\">${item.code}</button>`).join('') || '<div class=\"events\">No valid targets.</div>'}\n    </div>\n    ${activeNeighbour ? `<div class=\"dip-target-name\">Target: ${activeNeighbour.name} (${activeNeighbour.code})</div>` : ''}\n    <div class=\"dip-actions\">${diplomaticButtons}</div>\n\n    <h3>Neighbours</h3>\n    <div class=\"neighbour-head\">\n      <label for=\"neighbour-sort\" class=\"neighbour-sort-label\">Sort by</label>\n      <select id=\"neighbour-sort\" class=\"neighbour-sort\" data-neighbour-sort>\n        ${NEIGHBOUR_SORT_MODES.map((mode) => `<option value=\"${mode.value}\" ${node.__sortMode === mode.value ? 'selected' : ''}>${mode.label}</option>`).join('')}\n      </select>\n    </div>\n    <div class=\"neighbours\" data-dossier-neighbours>${neighbours.map((n) => `\n      <div class=\"neighbour-row\" title=\"Relationship and tension are deterministic border metrics.\">\n        <div class=\"neighbour-title\"><strong>${n.code}</strong> ${n.name}</div>\n        ${relBar(n.rel)}\n        ${tensionBar(n.tension)}\n        ${trustBar(n.trust)}\n        <div class=\"neighbour-meta\"><span>Posture: ${relLabel(n.rel, n.tension)}</span><span>Rel ${n.rel}</span><span>Tension ${n.tension}</span><span>Trust ${n.trust}</span><span>Power ${n.powerRatio.toFixed(2)}x</span></div>\n      </div>\n    `).join('') || '<div class=\"events\">No land neighbours in this dataset.</div>'}</div>\n    <h3>Recent events</h3>\n    <div class=\"events\" data-dossier-events>${state.events.filter((e) => e.cca3 === selected.cca3 || e.secondary === selected.cca3).slice(0, 8).map((e) => `<div>T${e.turn}: ${e.text}${e.secondary ? ` (${e.cca3} \u2194 ${e.secondary})` : ''}</div>`).join('') || '<div>None.</div>'}</div>\n  `;\n\n  if (node.__lastMarkup !== markup) {\n    node.innerHTML = markup;\n    node.__lastMarkup = markup;\n\n    const sortSelect = node.querySelector('[data-neighbour-sort]');\n    if (sortSelect) {\n      sortSelect.onchange = (event) => {\n        node.__sortMode = event.currentTarget.value;\n        node.__lastMarkup = '';\n        onUiStateChange?.();\n      };\n    }\n\n    node.querySelectorAll('[data-policy-field]').forEach((input) => {\n      const field = input.getAttribute('data-policy-field');\n      const eventName = input.tagName === 'SELECT' ? 'change' : 'input';\n      input.addEventListener(eventName, (event) => {\n        actions.setPolicyField(field, event.currentTarget.value, selected.cca3);\n      });\n    });\n\n    node.querySelectorAll('[data-policy-step]').forEach((btn) => {\n      btn.onclick = () => {\n        const delta = Number(btn.getAttribute('data-policy-step'));\n        const current = Number(state.dynamic?.[selected.cca3]?.policy?.milTargetPct ?? 0.6);\n        actions.setPolicyField('milTargetPct', current + delta, selected.cca3);\n      };\n    });\n\n    node.querySelectorAll('[data-target]').forEach((btn) => {\n      btn.onclick = () => {\n        node.__diplomacyTarget = btn.getAttribute('data-target');\n        node.__lastMarkup = '';\n        onUiStateChange?.();\n      };\n    });\n\n    node.querySelectorAll('[data-action-type]').forEach((btn) => {\n      btn.onclick = () => {\n        if (!node.__diplomacyTarget) return;\n        actions.queuePlayerDiplomaticAction(btn.getAttribute('data-action-type'), node.__diplomacyTarget, selected.cca3);\n      };\n    });\n  }\n\n  node.classList.toggle('open', state.dossierOpen);\n}\n\nexport function updateDossierLiveTelemetry(node, state) {\n  const selectedCode = state.selected;\n  if (!selectedCode || !node.querySelector('[data-dossier-events]')) return;\n\n  const turnValue = node.querySelector('[data-dossier-turn]');\n  if (turnValue) turnValue.textContent = String(state.turn);\n\n  const selected = state.countryIndex[selectedCode];\n  if (!selected) return;\n\n  const neighboursNode = node.querySelector('[data-dossier-neighbours]');\n  if (neighboursNode) {\n    const neighbours = sortNeighbours(selected, state, node.__sortMode || 'worst-relationship');\n    neighboursNode.innerHTML = neighbours.map((n) => `\n      <div class=\"neighbour-row\" title=\"Relationship and tension are deterministic border metrics.\">\n        <div class=\"neighbour-title\"><strong>${n.code}</strong> ${n.name}</div>\n        ${relBar(n.rel)}\n        ${tensionBar(n.tension)}\n        ${trustBar(n.trust)}\n        <div class=\"neighbour-meta\"><span>Posture: ${relLabel(n.rel, n.tension)}</span><span>Rel ${n.rel}</span><span>Tension ${n.tension}</span><span>Trust ${n.trust}</span><span>Power ${n.powerRatio.toFixed(2)}x</span></div>\n      </div>\n    `).join('') || '<div class=\"events\">No land neighbours in this dataset.</div>';\n  }\n\n  const eventsNode = node.querySelector('[data-dossier-events]');\n  if (eventsNode) {\n    eventsNode.innerHTML = state.events\n      .filter((e) => e.cca3 === selected.cca3 || e.secondary === selected.cca3)\n      .slice(0, 8)\n      .map((e) => `<div>T${e.turn}: ${e.text}${e.secondary ? ` (${e.cca3} \u2194 ${e.secondary})` : ''}</div>`)\n      .join('') || '<div>None.</div>';\n  }\n}\n", "import { fmtCompact } from '../util/format.js';\n\nexport function renderTooltip(node, state, x, y) {\n  if (!state.hovered) {\n    node.hidden = true;\n    return;\n  }\n  const c = state.countryIndex[state.hovered];\n  const d = state.dynamic[state.hovered];\n  const markup = `<strong>${c?.name ?? state.hovered}</strong><div>Pop: ${fmtCompact(c?.population)}</div><div>GDP: ${fmtCompact(d?.gdp)}</div>`;\n  node.hidden = false;\n  node.style.left = `${x + 14}px`;\n  node.style.top = `${y + 14}px`;\n  if (node.__lastMarkup !== markup) {\n    node.innerHTML = markup;\n    node.__lastMarkup = markup;\n  }\n}\n", "function getActiveMetricValue(metric, dynamicEntry, country) {\n  if (metric === 'militaryPercentGdp') return dynamicEntry?.militaryPct;\n  if (metric === 'gdp') return dynamicEntry?.gdp;\n  return country?.indicators?.[metric];\n}\n\nlet memoKey = '';\nlet memoDynamic = null;\nlet memoCountryIndex = null;\nlet memoRange = { min: 0, max: 1 };\n\nexport function selectActiveMetricRange(state) {\n  const key = `${state.metric}:${state.turn}`;\n  if (memoKey === key && memoDynamic === state.dynamic && memoCountryIndex === state.countryIndex) {\n    return memoRange;\n  }\n\n  const values = Object.keys(state.dynamic)\n    .map((cca3) => getActiveMetricValue(state.metric, state.dynamic[cca3], state.countryIndex[cca3]))\n    .filter(Number.isFinite);\n\n  const min = values.length ? Math.min(...values) : 0;\n  const max = values.length ? Math.max(...values) : 1;\n\n  memoKey = key;\n  memoDynamic = state.dynamic;\n  memoCountryIndex = state.countryIndex;\n  memoRange = { min, max };\n  return memoRange;\n}\n\nexport function selectActiveMetricValue(state, cca3) {\n  return getActiveMetricValue(state.metric, state.dynamic[cca3], state.countryIndex[cca3]);\n}\n", "import { fmtCompact } from '../util/format.js';\nimport { selectActiveMetricRange } from '../state/metricRange.js';\n\nexport function renderLegend(node, state) {\n  if (state.overlay === 'heatmap') {\n    node.hidden = false;\n    const { min, max } = selectActiveMetricRange(state);\n    const markup = `<div><strong>${state.metric}</strong></div><div>${fmtCompact(min)} \u2192 ${fmtCompact(max)}</div>`;\n    if (node.__lastMarkup !== markup) {\n      node.innerHTML = markup;\n      node.__lastMarkup = markup;\n    }\n    return;\n  }\n\n  if (state.overlay === 'diplomacy') {\n    node.hidden = false;\n    const markup = state.selected\n      ? '<div><strong>Diplomacy</strong></div><div>Green: positive \u00B7 Gray: neutral \u00B7 Red: negative</div><div>Stroke intensity = border tension</div>'\n      : '<div><strong>Diplomacy</strong></div><div>Select a country to view neighbour relations.</div>';\n    if (node.__lastMarkup !== markup) {\n      node.innerHTML = markup;\n      node.__lastMarkup = markup;\n    }\n    return;\n  }\n\n  node.hidden = true;\n}\n", "export function renderDebug(node, state) {\n  node.hidden = !state.debug;\n  if (!state.debug) return;\n  const markup = `FPS ${state.debugInfo.fps}<br/>Turn ${state.turn}<br/>Hover ${state.hovered ?? '\u2014'}<br/>Candidates ${state.debugInfo.candidates}<br/>Render ${state.debugInfo.renderMs.toFixed(2)} ms`;\n  if (node.__lastMarkup !== markup) {\n    node.innerHTML = markup;\n    node.__lastMarkup = markup;\n  }\n}\n", "import { serializeRelations } from '../state/relationships.js';\n\nconst KEY = 'total-war-v0-save';\nconst SNAPSHOT_SCHEMA_VERSION = 2;\n\nfunction isNonEmptyObject(value) {\n  return value != null && typeof value === 'object' && !Array.isArray(value) && Object.keys(value).length > 0;\n}\n\nfunction buildCountryFieldMap(dynamic = {}, pickField) {\n  const entries = Object.entries(dynamic)\n    .map(([cca3, entry]) => [cca3, pickField(entry)])\n    .filter(([, value]) => value != null)\n    .sort(([a], [b]) => a.localeCompare(b));\n  return Object.fromEntries(entries);\n}\n\nfunction collectSparseEdgeExtras(edges = [], relations = {}, relationEdgeExtras = {}) {\n  const sparse = {};\n  for (const [a, b] of edges) {\n    const edge = relations?.[a]?.[b];\n    const bakedExtras = edge?.extras;\n    const keyedExtras = relationEdgeExtras?.[`${a}|${b}`] ?? relationEdgeExtras?.[`${b}|${a}`];\n    const extras = isNonEmptyObject(bakedExtras) ? bakedExtras : keyedExtras;\n    if (!isNonEmptyObject(extras)) continue;\n    const key = a < b ? `${a}|${b}` : `${b}|${a}`;\n    sparse[key] = extras;\n  }\n  return sparse;\n}\n\nexport function makeSnapshot(state) {\n  const countryInfluence = buildCountryFieldMap(state.dynamic, (entry) => entry?.influence ?? null);\n  const countryPolicy = buildCountryFieldMap(state.dynamic, (entry) => entry?.policy ?? null);\n  const countryActionState = buildCountryFieldMap(state.dynamic, (entry) => ({\n    actionUsedTurn: entry?.actionUsedTurn ?? null,\n    cooldowns: entry?.cooldowns ?? {}\n  }));\n\n  return {\n    schemaVersion: SNAPSHOT_SCHEMA_VERSION,\n    seed: state.seed,\n    turn: state.turn,\n    paused: state.paused,\n    speed: state.speed,\n    camera: state.camera,\n    selected: state.selected,\n    overlay: state.overlay,\n    metric: state.metric,\n    dynamic: state.dynamic,\n    countryInfluence,\n    countryPolicy,\n    countryActionState,\n    events: state.events,\n    postureByCountry: state.postureByCountry,\n    relationsEdges: serializeRelations(state.relationEdges, state.relations),\n    relationEffects: state.relationEffects,\n    pacts: state.relationEffects,\n    relationEdgeExtras: collectSparseEdgeExtras(state.relationEdges, state.relations, state.relationEdgeExtras)\n  };\n}\n\nexport function saveToLocal(snapshot) {\n  localStorage.setItem(KEY, JSON.stringify(snapshot));\n}\n\nexport function loadFromLocal() {\n  const raw = localStorage.getItem(KEY);\n  if (!raw) return null;\n  try {\n    return JSON.parse(raw);\n  } catch {\n    return null;\n  }\n}\n\nexport function exportJson(snapshot) {\n  const blob = new Blob([JSON.stringify(snapshot, null, 2)], { type: 'application/json' });\n  const a = document.createElement('a');\n  a.href = URL.createObjectURL(blob);\n  a.download = `total-war-save-${Date.now()}.json`;\n  a.click();\n}\n\nexport function importJsonFile() {\n  return new Promise((resolve) => {\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = 'application/json';\n    input.onchange = async () => {\n      const file = input.files?.[0];\n      if (!file) return resolve(null);\n      const text = await file.text();\n      try {\n        resolve(JSON.parse(text));\n      } catch {\n        resolve(null);\n      }\n    };\n    input.click();\n  });\n}\n", "export const DEFAULT_INFLUENCE = 5;\nexport const DEFAULT_POLICY = Object.freeze({\n  milTargetPct: 0.6,\n  growthFocus: 50,\n  stabilityFocus: 50,\n  stance: 'neutral'\n});\n\nconst STANCES = new Set(['conciliatory', 'neutral', 'hardline']);\n\nfunction clamp(value, min, max) {\n  return Math.min(max, Math.max(min, value));\n}\n\nfunction toNumber(value, fallback) {\n  const num = Number(value);\n  return Number.isFinite(num) ? num : fallback;\n}\n\nfunction toInt(value, fallback) {\n  return Math.round(toNumber(value, fallback));\n}\n\nexport function clampInfluence(value) {\n  return clamp(toInt(value, DEFAULT_INFLUENCE), 0, 100);\n}\n\nexport function clampPolicy(policy = {}) {\n  const milTargetPct = clamp(toNumber(policy.milTargetPct, DEFAULT_POLICY.milTargetPct), 0.5, 10 / 12);\n  const growthFocus = clamp(toInt(policy.growthFocus, DEFAULT_POLICY.growthFocus), 0, 100);\n  const stabilityFocus = clamp(toInt(policy.stabilityFocus, DEFAULT_POLICY.stabilityFocus), 0, 100);\n  const stance = STANCES.has(policy.stance) ? policy.stance : DEFAULT_POLICY.stance;\n  return { milTargetPct, growthFocus, stabilityFocus, stance };\n}\n\nexport function clampActionUsage(actionState = {}) {\n  const actionUsedTurn = Number.isInteger(actionState.actionUsedTurn) ? actionState.actionUsedTurn : null;\n  const cooldowns = Object.fromEntries(\n    Object.entries(actionState.cooldowns ?? {}).map(([action, turns]) => [action, Math.max(0, toInt(turns, 0))])\n  );\n  return { actionUsedTurn, cooldowns };\n}\n\nexport function normalizeDynamicEntry(entry = {}) {\n  const actionState = clampActionUsage(entry);\n  return {\n    ...entry,\n    influence: clampInfluence(entry.influence),\n    policy: clampPolicy(entry.policy),\n    actionUsedTurn: actionState.actionUsedTurn,\n    cooldowns: actionState.cooldowns\n  };\n}\n\nexport function normalizeDynamicState(dynamic = {}, countryIndex = {}) {\n  return Object.keys(countryIndex).reduce((acc, cca3) => {\n    acc[cca3] = normalizeDynamicEntry(dynamic[cca3]);\n    return acc;\n  }, {});\n}\n", "import { countryTurnRng, pairKey } from '../util/rng.js';\nimport { initRelations, stepRelations } from './relationships.js';\nimport { TURN_INFLUENCE_CONFIG, buildTopGdpCountrySet, computeInfluenceGain, applyInfluenceGain } from './influence.js';\nimport { normalizeDynamicEntry, DEFAULT_INFLUENCE, DEFAULT_POLICY } from './policies.js';\nimport { planActions, applyPlannedActions } from './diplomaticActions.js';\nimport { createInitialRelationEffectsState, runRelationEffectsStage } from './relationEffects.js';\n\nfunction clamp(value, min, max) {\n  return Math.max(min, Math.min(max, value));\n}\n\n// Policy stage tuning constants (kept close to simulation logic for easy balancing).\nconst POLICY_MILITARY_MIN_PCT = 0.2;\nconst POLICY_MILITARY_MAX_PCT = 12;\nconst POLICY_MILITARY_MAX_DELTA_PER_TURN = 0.2;\nconst POLICY_GROWTH_MOD_MIN = -0.02;\nconst POLICY_GROWTH_MOD_MAX = 0.02;\nconst POLICY_STABILITY_DELTA_MIN = -0.03;\nconst POLICY_STABILITY_DELTA_MAX = 0.03;\n\nconst STANCE_POLICY_EFFECTS = {\n  hardline: { growth: -0.0015, stability: -0.002, trustDelta: -1 },\n  neutral: { growth: 0, stability: 0, trustDelta: 0 },\n  conciliatory: { growth: 0.0015, stability: 0.002, trustDelta: 1 }\n};\n\nfunction getPolicy(entry) {\n  const policy = entry.policy ?? {};\n  return {\n    milTargetPct: clamp(policy.milTargetPct ?? entry.militaryPct ?? 2.5, POLICY_MILITARY_MIN_PCT, POLICY_MILITARY_MAX_PCT),\n    growthFocus: clamp(policy.growthFocus ?? 50, 0, 100),\n    stabilityFocus: clamp(policy.stabilityFocus ?? 50, 0, 100),\n    stance: STANCE_POLICY_EFFECTS[policy.stance] ? policy.stance : 'neutral'\n  };\n}\n\nfunction computePower(gdp, militaryPct, population) {\n  const milAbs = Math.max(0, gdp * (militaryPct / 100));\n  return Math.sqrt(milAbs) * 0.6 + Math.sqrt(Math.max(0, gdp)) * 0.3 + Math.sqrt(Math.max(0, population)) * 0.1;\n}\n\nexport function createStore(initialState) {\n  let state = initialState;\n  const listeners = new Set();\n  return {\n    getState: () => state,\n    setState(update) {\n      state = typeof update === 'function' ? update(state) : { ...state, ...update };\n      listeners.forEach((fn) => fn(state));\n    },\n    subscribe(fn) {\n      listeners.add(fn);\n      return () => listeners.delete(fn);\n    }\n  };\n}\n\nexport function createInitialSimState(countryIndex) {\n  const dynamic = {};\n  Object.values(countryIndex).forEach((country) => {\n    const gdp = country.indicators.gdp;\n    const militaryPct = country.indicators.militaryPercentGdp;\n    const militarySpendAbs = gdp * (militaryPct / 100);\n    dynamic[country.cca3] = {\n      gdp,\n      militaryPct,\n      policy: {\n        milTargetPct: clamp(militaryPct, POLICY_MILITARY_MIN_PCT, POLICY_MILITARY_MAX_PCT),\n        growthFocus: DEFAULT_POLICY.growthFocus,\n        stabilityFocus: DEFAULT_POLICY.stabilityFocus,\n        stance: DEFAULT_POLICY.stance\n      },\n      relations: {},\n      growthMod: 0,\n      modTurns: 0,\n      aiBias: 0.5,\n      growthRate: 0.01,\n      stability: 0.55,\n      influence: DEFAULT_INFLUENCE,\n      militarySpendAbs,\n      power: computePower(gdp, militaryPct, country.population ?? country.indicators.population ?? 0),\n      actionUsedTurn: null,\n      cooldowns: {}\n    };\n    dynamic[country.cca3] = normalizeDynamicEntry(dynamic[country.cca3]);\n  });\n  return dynamic;\n}\n\nexport function createInitialRelations(seed, neighbours, countryIndex) {\n  return initRelations(seed, neighbours, countryIndex);\n}\n\nexport function createInitialRelationEffects() {\n  return createInitialRelationEffectsState();\n}\n\nexport function simulateTurn(state) {\n  const nextTurn = state.turn + 1;\n  const countryCodes = Object.keys(state.dynamic).sort((a, b) => a.localeCompare(b));\n  const sortedRelationEdges = [...(state.relationEdges ?? [])].sort((left, right) => {\n    const [a1, b1] = left;\n    const [a2, b2] = right;\n    return pairKey(a1, b1).localeCompare(pairKey(a2, b2));\n  });\n\n  const nextDynamic = {};\n  const events = [];\n  const relationInputsByCountry = {};\n  const economyInputsByCountry = {};\n  const relationEffectsStage = runRelationEffectsStage(state.relationEffects, nextTurn);\n\n  // Stage 1: policy adjustments (deterministic country iteration by sorted cca3).\n  for (const cca3 of countryCodes) {\n    const entry = state.dynamic[cca3];\n    const policy = getPolicy(entry);\n    const stanceEffects = STANCE_POLICY_EFFECTS[policy.stance];\n    const militaryDelta = clamp(\n      policy.milTargetPct - entry.militaryPct,\n      -POLICY_MILITARY_MAX_DELTA_PER_TURN,\n      POLICY_MILITARY_MAX_DELTA_PER_TURN\n    );\n    const militaryPct = clamp(entry.militaryPct + militaryDelta, POLICY_MILITARY_MIN_PCT, POLICY_MILITARY_MAX_PCT);\n    const growthFocusNorm = policy.growthFocus / 100;\n    const stabilityFocusNorm = policy.stabilityFocus / 100;\n    const stabilityPolicyDelta = clamp(\n      (stabilityFocusNorm - 0.5) * 0.03\n        - (growthFocusNorm - 0.5) * 0.012\n        + stanceEffects.stability,\n      POLICY_STABILITY_DELTA_MIN,\n      POLICY_STABILITY_DELTA_MAX\n    );\n\n    nextDynamic[cca3] = {\n      ...entry,\n      policy,\n      militaryPct,\n      stability: clamp((entry.stability ?? 0.55) + stabilityPolicyDelta, 0, 1)\n    };\n  }\n\n  // Stage 2: derived stats from policy-adjusted values.\n  for (const cca3 of countryCodes) {\n    const entry = nextDynamic[cca3];\n    const country = state.countryIndex[cca3];\n    entry.militarySpendAbs = entry.gdp * (entry.militaryPct / 100);\n    entry.power = computePower(entry.gdp, entry.militaryPct, country?.population ?? 0);\n  }\n\n  // Stage 3: base events and per-country turn inputs.\n  for (const cca3 of countryCodes) {\n    const entry = nextDynamic[cca3];\n    const rng = countryTurnRng(state.seed, nextTurn, cca3, 'sim');\n    const stanceEffects = STANCE_POLICY_EFFECTS[entry.policy.stance];\n    const drift = (rng() - 0.5) * 0.012;\n    const eventRoll = rng();\n    let growthMod = entry.modTurns > 0 ? entry.growthMod : 0;\n    let modTurns = Math.max(0, entry.modTurns - 1);\n\n    if (eventRoll < 0.012) {\n      growthMod = rng() < 0.5 ? -0.018 : 0.02;\n      modTurns = 3 + Math.floor(rng() * 4);\n      events.push({ turn: nextTurn, cca3, text: growthMod > 0 ? 'Investment boom' : 'Economic shock' });\n    }\n\n    const growthFocusNorm = entry.policy.growthFocus / 100;\n    const stabilityFocusNorm = entry.policy.stabilityFocus / 100;\n    const growthPolicyMod = clamp(\n      (growthFocusNorm - 0.5) * 0.01\n        + (0.5 - stabilityFocusNorm) * 0.004\n        + stanceEffects.growth,\n      POLICY_GROWTH_MOD_MIN,\n      POLICY_GROWTH_MOD_MAX\n    );\n\n    relationInputsByCountry[cca3] = {\n      trustDelta: stanceEffects.trustDelta\n    };\n\n    economyInputsByCountry[cca3] = {\n      drift,\n      growthMod,\n      modTurns,\n      growthPolicyMod\n    };\n\n    entry.growthMod = growthMod;\n    entry.modTurns = modTurns;\n  }\n\n  // Stage 4: plan/apply diplomacy actions on a deterministic snapshot.\n  const plannedActions = planActions({\n    ...state,\n    turn: nextTurn,\n    dynamic: nextDynamic,\n    relations: state.relations,\n    relationEdges: sortedRelationEdges\n  });\n  const diplomaticStep = applyPlannedActions({\n    ...state,\n    turn: nextTurn,\n    dynamic: nextDynamic,\n    relations: state.relations,\n    relationEdges: sortedRelationEdges\n  }, plannedActions);\n\n  // Stage 5: passive relation step (stable sorted edge tuples).\n  const relStep = stepRelations({\n    turn: nextTurn,\n    seed: state.seed,\n    relations: diplomaticStep.relations,\n    edges: sortedRelationEdges,\n    dynamic: diplomaticStep.dynamic,\n    relationInputsByCountry,\n    events\n  });\n\n  for (const cca3 of countryCodes) {\n    const postures = Object.entries(relStep.postureByCountry[cca3] ?? {})\n      .sort(([a], [b]) => a.localeCompare(b))\n      .map(([, posture]) => posture);\n    const hostile = postures.filter((p) => p === 'Hostile').length;\n    if (!postures.length) continue;\n    const hostilityRate = hostile / postures.length;\n    diplomaticStep.dynamic[cca3].militaryPct = clamp(\n      diplomaticStep.dynamic[cca3].militaryPct + hostilityRate * 0.08,\n      POLICY_MILITARY_MIN_PCT,\n      POLICY_MILITARY_MAX_PCT\n    );\n    diplomaticStep.dynamic[cca3].militarySpendAbs = diplomaticStep.dynamic[cca3].gdp * (diplomaticStep.dynamic[cca3].militaryPct / 100);\n    diplomaticStep.dynamic[cca3].power = computePower(\n      diplomaticStep.dynamic[cca3].gdp,\n      diplomaticStep.dynamic[cca3].militaryPct,\n      state.countryIndex[cca3]?.population ?? 0\n    );\n  }\n\n  // Stage 6: economy update.\n  for (const cca3 of countryCodes) {\n    const entry = diplomaticStep.dynamic[cca3];\n    const economy = economyInputsByCountry[cca3];\n    const growth = 0.01\n      + economy.drift\n      + economy.growthMod\n      + economy.growthPolicyMod\n      + (relationEffectsStage.growthDeltaByCountry[cca3] ?? 0);\n    const gdp = Math.max(1, entry.gdp * (1 + growth));\n\n    entry.gdp = gdp;\n    entry.growthRate = growth;\n    entry.militarySpendAbs = gdp * (entry.militaryPct / 100);\n    entry.power = computePower(gdp, entry.militaryPct, state.countryIndex[cca3]?.population ?? 0);\n  }\n\n  // Stage 7: influence gain.\n  const topGdpCountries = buildTopGdpCountrySet(diplomaticStep.dynamic, TURN_INFLUENCE_CONFIG.topGdpPercentile);\n  for (const cca3 of countryCodes) {\n    const entry = diplomaticStep.dynamic[cca3];\n    const gain = computeInfluenceGain(entry, topGdpCountries.has(cca3), TURN_INFLUENCE_CONFIG);\n    entry.influence = applyInfluenceGain(entry, gain, TURN_INFLUENCE_CONFIG.maxInfluence);\n  }\n\n  return {\n    ...state,\n    turn: nextTurn,\n    dynamic: diplomaticStep.dynamic,\n    relations: relStep.relations,\n    postureByCountry: relStep.postureByCountry,\n    relationEffects: diplomaticStep.relationEffects ?? relationEffectsStage.relationEffects,\n    queuedPlayerAction: null,\n    events: [...diplomaticStep.events, ...relStep.relationEvents, ...events, ...state.events].slice(0, 80)\n  };\n}\n", "import { simulateTurn, createInitialRelations, createInitialSimState, createInitialRelationEffects } from './store.js';\nimport { edgeKey, hydrateRelations } from './relationships.js';\nimport { clampActionUsage, clampInfluence, clampPolicy, normalizeDynamicState } from './policies.js';\nimport { hydrateRelationEffectsState } from './relationEffects.js';\nimport { ACTION_DEFINITIONS, checkActionPreconditions } from './diplomaticActions.js';\n\nfunction toObject(value, fallback = {}) {\n  return value != null && typeof value === 'object' && !Array.isArray(value) ? value : fallback;\n}\n\nfunction toFiniteNumber(value, fallback) {\n  const num = Number(value);\n  return Number.isFinite(num) ? num : fallback;\n}\n\nfunction toInteger(value, fallback) {\n  return Math.round(toFiniteNumber(value, fallback));\n}\n\nfunction isKnownCountry(countryIndex, cca3) {\n  return typeof cca3 === 'string' && Object.prototype.hasOwnProperty.call(countryIndex, cca3);\n}\n\nfunction normalizeCountrySparseMap(raw, countryIndex, mapValue) {\n  const source = toObject(raw);\n  const entries = Object.entries(source)\n    .filter(([cca3]) => isKnownCountry(countryIndex, cca3))\n    .sort(([a], [b]) => a.localeCompare(b))\n    .map(([cca3, value]) => [cca3, mapValue(value)]);\n  return Object.fromEntries(entries);\n}\n\nfunction normalizeEffectsList(rawList, normalizeItem) {\n  if (!Array.isArray(rawList)) return [];\n  const list = rawList\n    .map((item) => normalizeItem(toObject(item, null)))\n    .filter(Boolean);\n  return list;\n}\n\nfunction normalizeRelationEffects(rawRelationEffects) {\n  const source = toObject(rawRelationEffects);\n\n  const guaranteesByEdge = Object.fromEntries(\n    Object.entries(toObject(source.guaranteesByEdge))\n      .sort(([a], [b]) => a.localeCompare(b))\n      .map(([key, guarantees]) => [key, normalizeEffectsList(guarantees, (item) => {\n        if (!item?.actor || !item?.target) return null;\n        return {\n          actor: item.actor,\n          target: item.target,\n          expiryTurn: Math.max(0, toInteger(item.expiryTurn, 0))\n        };\n      })])\n      .filter(([, guarantees]) => guarantees.length)\n  );\n\n  const sanctionsByEdge = Object.fromEntries(\n    Object.entries(toObject(source.sanctionsByEdge))\n      .sort(([a], [b]) => a.localeCompare(b))\n      .map(([key, sanctions]) => [key, normalizeEffectsList(sanctions, (item) => {\n        if (!item?.actor || !item?.target) return null;\n        return {\n          actor: item.actor,\n          target: item.target,\n          expiryTurn: Math.max(0, toInteger(item.expiryTurn, 0)),\n          growthPenaltyActor: toFiniteNumber(item.growthPenaltyActor, 0),\n          growthPenaltyTarget: toFiniteNumber(item.growthPenaltyTarget, 0)\n        };\n      })])\n      .filter(([, sanctions]) => sanctions.length)\n  );\n\n  const tradeByEdge = Object.fromEntries(\n    Object.entries(toObject(source.tradeByEdge))\n      .sort(([a], [b]) => a.localeCompare(b))\n      .map(([key, trade]) => {\n        const next = {};\n        if (Number.isFinite(Number(trade?.level))) next.level = Math.max(0, toInteger(trade.level, 0));\n        if (Number.isFinite(Number(trade?.buffExpiryTurn))) next.buffExpiryTurn = Math.max(0, toInteger(trade.buffExpiryTurn, 0));\n        return [key, next];\n      })\n      .filter(([, trade]) => Object.keys(trade).length)\n  );\n\n  return { guaranteesByEdge, sanctionsByEdge, tradeByEdge };\n}\n\nfunction mergeCountryDynamicState(baseDynamic, countryInfluence, countryPolicy, countryActionState) {\n  const merged = {};\n  for (const [cca3, entry] of Object.entries(baseDynamic)) {\n    const actionState = clampActionUsage(countryActionState?.[cca3] ?? entry);\n    merged[cca3] = {\n      ...entry,\n      influence: clampInfluence(countryInfluence?.[cca3] ?? entry.influence),\n      policy: clampPolicy(countryPolicy?.[cca3] ?? entry.policy),\n      actionUsedTurn: actionState.actionUsedTurn,\n      cooldowns: actionState.cooldowns\n    };\n  }\n  return merged;\n}\n\nfunction normalizeRelationEdgeExtras(raw, validEdges) {\n  const source = toObject(raw);\n  const sparse = {};\n  const validSet = new Set(validEdges.map(([a, b]) => edgeKey(a, b)));\n  for (const [key, extras] of Object.entries(source).sort(([a], [b]) => a.localeCompare(b))) {\n    if (!validSet.has(key)) continue;\n    if (extras == null || typeof extras !== 'object' || Array.isArray(extras)) continue;\n    if (!Object.keys(extras).length) continue;\n    sparse[key] = { ...extras };\n  }\n  return sparse;\n}\n\nfunction mergeLegacyRelationEdgeExtras(rawRelationEdges = [], rawEdgeExtras = {}) {\n  const merged = { ...toObject(rawEdgeExtras) };\n  for (const row of rawRelationEdges) {\n    if (!Array.isArray(row) || row.length < 7) continue;\n    const [a, b, , , , , extras] = row;\n    if (!a || !b || extras == null || typeof extras !== 'object' || Array.isArray(extras) || !Object.keys(extras).length) continue;\n    merged[edgeKey(a, b)] = extras;\n  }\n  return merged;\n}\n\nfunction parseSnapshot(snapshot, baseState) {\n  const safeSnapshot = toObject(snapshot, null);\n  if (!safeSnapshot) return null;\n\n  const rawRelationEdges = Array.isArray(safeSnapshot.relationsEdges)\n    ? safeSnapshot.relationsEdges\n    : Array.isArray(safeSnapshot.relationEdges) ? safeSnapshot.relationEdges : [];\n  const hydrated = hydrateRelations(baseState.neighbours, rawRelationEdges);\n\n  const dynamicBase = normalizeDynamicState(safeSnapshot.dynamic, baseState.countryIndex);\n  const countryInfluence = normalizeCountrySparseMap(\n    safeSnapshot.countryInfluence ?? safeSnapshot.influenceByCountry,\n    baseState.countryIndex,\n    (value) => clampInfluence(value)\n  );\n  const countryPolicy = normalizeCountrySparseMap(\n    safeSnapshot.countryPolicy ?? safeSnapshot.policyByCountry,\n    baseState.countryIndex,\n    (value) => clampPolicy(toObject(value))\n  );\n  const countryActionState = normalizeCountrySparseMap(\n    safeSnapshot.countryActionState ?? safeSnapshot.actionUsageByCountry,\n    baseState.countryIndex,\n    (value) => clampActionUsage(toObject(value))\n  );\n\n  const mergedEffects = {\n    ...toObject(safeSnapshot.pacts),\n    ...toObject(safeSnapshot.relationEffects)\n  };\n  const relationEffects = hydrateRelationEffectsState(normalizeRelationEffects(mergedEffects));\n\n  const relationEdgeExtras = normalizeRelationEdgeExtras(\n    mergeLegacyRelationEdgeExtras(rawRelationEdges, safeSnapshot.relationEdgeExtras),\n    hydrated.edges\n  );\n\n  return {\n    seed: safeSnapshot.seed ?? baseState.seed,\n    turn: Math.max(0, toInteger(safeSnapshot.turn, baseState.turn)),\n    paused: typeof safeSnapshot.paused === 'boolean' ? safeSnapshot.paused : baseState.paused,\n    speed: toFiniteNumber(safeSnapshot.speed, baseState.speed),\n    camera: toObject(safeSnapshot.camera, baseState.camera),\n    selected: typeof safeSnapshot.selected === 'string' ? safeSnapshot.selected : baseState.selected,\n    overlay: safeSnapshot.overlay ?? baseState.overlay,\n    metric: safeSnapshot.metric ?? baseState.metric,\n    events: Array.isArray(safeSnapshot.events) ? safeSnapshot.events : [],\n    dynamic: mergeCountryDynamicState(dynamicBase, countryInfluence, countryPolicy, countryActionState),\n    relations: hydrated.relations,\n    relationEdges: hydrated.edges,\n    postureByCountry: toObject(safeSnapshot.postureByCountry),\n    relationEffects,\n    relationEdgeExtras,\n    queuedPlayerAction: toObject(safeSnapshot.queuedPlayerAction, null)\n  };\n}\n\nexport function createActions(store) {\n  return {\n    stepTurn() {\n      store.setState((s) => simulateTurn(s));\n    },\n    togglePause() {\n      store.setState((s) => ({ ...s, paused: !s.paused }));\n    },\n    setSpeed(speed) {\n      store.setState((s) => ({ ...s, speed }));\n    },\n    setHover(cca3) {\n      store.setState((s) => (s.hovered === cca3 ? s : { ...s, hovered: cca3 }));\n    },\n    selectCountry(cca3) {\n      store.setState((s) => ({ ...s, selected: cca3, dossierOpen: true }));\n    },\n    setOverlay(overlay) {\n      store.setState((s) => ({ ...s, overlay }));\n    },\n    setMetric(metric) {\n      store.setState((s) => ({ ...s, metric }));\n    },\n    setCamera(camera) {\n      store.setState((s) => ({ ...s, camera }));\n    },\n    toggleDebug() {\n      store.setState((s) => ({ ...s, debug: !s.debug }));\n    },\n    setSearch(value) {\n      store.setState((s) => ({ ...s, search: value }));\n    },\n    newGame(seed) {\n      store.setState((s) => {\n        const { relations, edges } = createInitialRelations(seed, s.neighbours, s.countryIndex);\n        return {\n          ...s,\n          seed,\n          turn: 0,\n          events: [],\n          dynamic: createInitialSimState(s.countryIndex),\n          relations,\n          relationEdges: edges,\n          postureByCountry: {},\n          relationEffects: createInitialRelationEffects(),\n          queuedPlayerAction: null\n        };\n      });\n    },\n    setPolicyField(field, value, cca3 = null) {\n      store.setState((s) => {\n        const actor = cca3 ?? s.selected;\n        if (!actor || !s.dynamic?.[actor]) return s;\n        if (!['milTargetPct', 'growthFocus', 'stabilityFocus', 'stance'].includes(field)) return s;\n        const entry = s.dynamic[actor];\n        const nextPolicy = clampPolicy({\n          ...(entry.policy ?? {}),\n          [field]: value\n        });\n        return {\n          ...s,\n          dynamic: {\n            ...s.dynamic,\n            [actor]: {\n              ...entry,\n              policy: nextPolicy\n            }\n          }\n        };\n      });\n    },\n    queuePlayerDiplomaticAction(type, target, actor = null) {\n      store.setState((s) => {\n        const actionActor = actor ?? s.selected;\n        if (!actionActor || !target || !ACTION_DEFINITIONS[type]) return s;\n        const action = { actor: actionActor, target, type, source: 'player' };\n        const check = checkActionPreconditions(s, action);\n        if (!check.ok) return s;\n        return { ...s, queuedPlayerAction: action };\n      });\n    },\n    clearQueuedPlayerDiplomaticAction() {\n      store.setState((s) => (s.queuedPlayerAction ? { ...s, queuedPlayerAction: null } : s));\n    },\n    loadState(snapshot) {\n      store.setState((s) => {\n        const parsed = parseSnapshot(snapshot, s);\n        if (!parsed) return s;\n        return {\n          ...s,\n          seed: parsed.seed,\n          turn: parsed.turn,\n          paused: parsed.paused,\n          speed: parsed.speed,\n          camera: parsed.camera,\n          selected: parsed.selected,\n          overlay: parsed.overlay,\n          metric: parsed.metric,\n          events: parsed.events,\n          dynamic: parsed.dynamic,\n          relations: parsed.relations,\n          relationEdges: parsed.relationEdges,\n          postureByCountry: parsed.postureByCountry,\n          relationEffects: parsed.relationEffects,\n          relationEdgeExtras: parsed.relationEdgeExtras,\n          queuedPlayerAction: parsed.queuedPlayerAction\n        };\n      });\n    }\n  };\n}\n", "export default function(x) {\n  return x;\n}\n", "import identity from \"./identity.js\";\n\nexport default function(transform) {\n  if (transform == null) return identity;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(input, i) {\n    if (!i) x0 = y0 = 0;\n    var j = 2, n = input.length, output = new Array(n);\n    output[0] = (x0 += input[0]) * kx + dx;\n    output[1] = (y0 += input[1]) * ky + dy;\n    while (j < n) output[j] = input[j], ++j;\n    return output;\n  };\n}\n", "export default function(array, n) {\n  var t, j = array.length, i = j - n;\n  while (i < --j) t = array[i], array[i++] = array[j], array[j] = t;\n}\n", "import reverse from \"./reverse.js\";\nimport transform from \"./transform.js\";\n\nexport default function(topology, o) {\n  if (typeof o === \"string\") o = topology.objects[o];\n  return o.type === \"GeometryCollection\"\n      ? {type: \"FeatureCollection\", features: o.geometries.map(function(o) { return feature(topology, o); })}\n      : feature(topology, o);\n}\n\nfunction feature(topology, o) {\n  var id = o.id,\n      bbox = o.bbox,\n      properties = o.properties == null ? {} : o.properties,\n      geometry = object(topology, o);\n  return id == null && bbox == null ? {type: \"Feature\", properties: properties, geometry: geometry}\n      : bbox == null ? {type: \"Feature\", id: id, properties: properties, geometry: geometry}\n      : {type: \"Feature\", id: id, bbox: bbox, properties: properties, geometry: geometry};\n}\n\nexport function object(topology, o) {\n  var transformPoint = transform(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {\n      points.push(transformPoint(a[k], k));\n    }\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    return transformPoint(p);\n  }\n\n  function line(arcs) {\n    var points = [];\n    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n    if (points.length < 2) points.push(points[0]); // This should never happen per the specification.\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n    while (points.length < 4) points.push(points[0]); // This may happen if an arc has only two points.\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type = o.type, coordinates;\n    switch (type) {\n      case \"GeometryCollection\": return {type: type, geometries: o.geometries.map(geometry)};\n      case \"Point\": coordinates = point(o.coordinates); break;\n      case \"MultiPoint\": coordinates = o.coordinates.map(point); break;\n      case \"LineString\": coordinates = line(o.arcs); break;\n      case \"MultiLineString\": coordinates = o.arcs.map(line); break;\n      case \"Polygon\": coordinates = polygon(o.arcs); break;\n      case \"MultiPolygon\": coordinates = o.arcs.map(polygon); break;\n      default: return null;\n    }\n    return {type: type, coordinates: coordinates};\n  }\n\n  return geometry(o);\n}\n", "// https://github.com/python/cpython/blob/a74eea238f5baba15797e2e8b570d153bc8690a7/Modules/mathmodule.c#L1423\nexport class Adder {\n  constructor() {\n    this._partials = new Float64Array(32);\n    this._n = 0;\n  }\n  add(x) {\n    const p = this._partials;\n    let i = 0;\n    for (let j = 0; j < this._n && j < 32; j++) {\n      const y = p[j],\n        hi = x + y,\n        lo = Math.abs(x) < Math.abs(y) ? x - (hi - y) : y - (hi - x);\n      if (lo) p[i++] = lo;\n      x = hi;\n    }\n    p[i] = x;\n    this._n = i + 1;\n    return this;\n  }\n  valueOf() {\n    const p = this._partials;\n    let n = this._n, x, y, lo, hi = 0;\n    if (n > 0) {\n      hi = p[--n];\n      while (n > 0) {\n        x = hi;\n        y = p[--n];\n        hi = x + y;\n        lo = y - (hi - x);\n        if (lo) break;\n      }\n      if (n > 0 && ((lo < 0 && p[n - 1] < 0) || (lo > 0 && p[n - 1] > 0))) {\n        y = lo * 2;\n        x = hi + y;\n        if (y == x - hi) hi = x;\n      }\n    }\n    return hi;\n  }\n}\n\nexport function fsum(values, valueof) {\n  const adder = new Adder();\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value = +value) {\n        adder.add(value);\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if (value = +valueof(value, ++index, values)) {\n        adder.add(value);\n      }\n    }\n  }\n  return +adder;\n}\n\nexport function fcumsum(values, valueof) {\n  const adder = new Adder();\n  let index = -1;\n  return Float64Array.from(values, valueof === undefined\n      ? v => adder.add(+v || 0)\n      : v => adder.add(+valueof(v, ++index, values) || 0)\n  );\n}\n", "function* flatten(arrays) {\n  for (const array of arrays) {\n    yield* array;\n  }\n}\n\nexport default function merge(arrays) {\n  return Array.from(flatten(arrays));\n}\n", "export var epsilon = 1e-6;\nexport var epsilon2 = 1e-12;\nexport var pi = Math.PI;\nexport var halfPi = pi / 2;\nexport var quarterPi = pi / 4;\nexport var tau = pi * 2;\n\nexport var degrees = 180 / pi;\nexport var radians = pi / 180;\n\nexport var abs = Math.abs;\nexport var atan = Math.atan;\nexport var atan2 = Math.atan2;\nexport var cos = Math.cos;\nexport var ceil = Math.ceil;\nexport var exp = Math.exp;\nexport var floor = Math.floor;\nexport var hypot = Math.hypot;\nexport var log = Math.log;\nexport var pow = Math.pow;\nexport var sin = Math.sin;\nexport var sign = Math.sign || function(x) { return x > 0 ? 1 : x < 0 ? -1 : 0; };\nexport var sqrt = Math.sqrt;\nexport var tan = Math.tan;\n\nexport function acos(x) {\n  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);\n}\n\nexport function asin(x) {\n  return x > 1 ? halfPi : x < -1 ? -halfPi : Math.asin(x);\n}\n\nexport function haversin(x) {\n  return (x = sin(x / 2)) * x;\n}\n", "export default function noop() {}\n", "function streamGeometry(geometry, stream) {\n  if (geometry && streamGeometryType.hasOwnProperty(geometry.type)) {\n    streamGeometryType[geometry.type](geometry, stream);\n  }\n}\n\nvar streamObjectType = {\n  Feature: function(object, stream) {\n    streamGeometry(object.geometry, stream);\n  },\n  FeatureCollection: function(object, stream) {\n    var features = object.features, i = -1, n = features.length;\n    while (++i < n) streamGeometry(features[i].geometry, stream);\n  }\n};\n\nvar streamGeometryType = {\n  Sphere: function(object, stream) {\n    stream.sphere();\n  },\n  Point: function(object, stream) {\n    object = object.coordinates;\n    stream.point(object[0], object[1], object[2]);\n  },\n  MultiPoint: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) object = coordinates[i], stream.point(object[0], object[1], object[2]);\n  },\n  LineString: function(object, stream) {\n    streamLine(object.coordinates, stream, 0);\n  },\n  MultiLineString: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) streamLine(coordinates[i], stream, 0);\n  },\n  Polygon: function(object, stream) {\n    streamPolygon(object.coordinates, stream);\n  },\n  MultiPolygon: function(object, stream) {\n    var coordinates = object.coordinates, i = -1, n = coordinates.length;\n    while (++i < n) streamPolygon(coordinates[i], stream);\n  },\n  GeometryCollection: function(object, stream) {\n    var geometries = object.geometries, i = -1, n = geometries.length;\n    while (++i < n) streamGeometry(geometries[i], stream);\n  }\n};\n\nfunction streamLine(coordinates, stream, closed) {\n  var i = -1, n = coordinates.length - closed, coordinate;\n  stream.lineStart();\n  while (++i < n) coordinate = coordinates[i], stream.point(coordinate[0], coordinate[1], coordinate[2]);\n  stream.lineEnd();\n}\n\nfunction streamPolygon(coordinates, stream) {\n  var i = -1, n = coordinates.length;\n  stream.polygonStart();\n  while (++i < n) streamLine(coordinates[i], stream, 1);\n  stream.polygonEnd();\n}\n\nexport default function(object, stream) {\n  if (object && streamObjectType.hasOwnProperty(object.type)) {\n    streamObjectType[object.type](object, stream);\n  } else {\n    streamGeometry(object, stream);\n  }\n}\n", "import {asin, atan2, cos, sin, sqrt} from \"./math.js\";\n\nexport function spherical(cartesian) {\n  return [atan2(cartesian[1], cartesian[0]), asin(cartesian[2])];\n}\n\nexport function cartesian(spherical) {\n  var lambda = spherical[0], phi = spherical[1], cosPhi = cos(phi);\n  return [cosPhi * cos(lambda), cosPhi * sin(lambda), sin(phi)];\n}\n\nexport function cartesianDot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\nexport function cartesianCross(a, b) {\n  return [a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0]];\n}\n\n// TODO return a\nexport function cartesianAddInPlace(a, b) {\n  a[0] += b[0], a[1] += b[1], a[2] += b[2];\n}\n\nexport function cartesianScale(vector, k) {\n  return [vector[0] * k, vector[1] * k, vector[2] * k];\n}\n\n// TODO return d\nexport function cartesianNormalizeInPlace(d) {\n  var l = sqrt(d[0] * d[0] + d[1] * d[1] + d[2] * d[2]);\n  d[0] /= l, d[1] /= l, d[2] /= l;\n}\n", "export default function(a, b) {\n\n  function compose(x, y) {\n    return x = a(x, y), b(x[0], x[1]);\n  }\n\n  if (a.invert && b.invert) compose.invert = function(x, y) {\n    return x = b.invert(x, y), x && a.invert(x[0], x[1]);\n  };\n\n  return compose;\n}\n", "import compose from \"./compose.js\";\nimport {abs, asin, atan2, cos, degrees, pi, radians, sin, tau} from \"./math.js\";\n\nfunction rotationIdentity(lambda, phi) {\n  if (abs(lambda) > pi) lambda -= Math.round(lambda / tau) * tau;\n  return [lambda, phi];\n}\n\nrotationIdentity.invert = rotationIdentity;\n\nexport function rotateRadians(deltaLambda, deltaPhi, deltaGamma) {\n  return (deltaLambda %= tau) ? (deltaPhi || deltaGamma ? compose(rotationLambda(deltaLambda), rotationPhiGamma(deltaPhi, deltaGamma))\n    : rotationLambda(deltaLambda))\n    : (deltaPhi || deltaGamma ? rotationPhiGamma(deltaPhi, deltaGamma)\n    : rotationIdentity);\n}\n\nfunction forwardRotationLambda(deltaLambda) {\n  return function(lambda, phi) {\n    lambda += deltaLambda;\n    if (abs(lambda) > pi) lambda -= Math.round(lambda / tau) * tau;\n    return [lambda, phi];\n  };\n}\n\nfunction rotationLambda(deltaLambda) {\n  var rotation = forwardRotationLambda(deltaLambda);\n  rotation.invert = forwardRotationLambda(-deltaLambda);\n  return rotation;\n}\n\nfunction rotationPhiGamma(deltaPhi, deltaGamma) {\n  var cosDeltaPhi = cos(deltaPhi),\n      sinDeltaPhi = sin(deltaPhi),\n      cosDeltaGamma = cos(deltaGamma),\n      sinDeltaGamma = sin(deltaGamma);\n\n  function rotation(lambda, phi) {\n    var cosPhi = cos(phi),\n        x = cos(lambda) * cosPhi,\n        y = sin(lambda) * cosPhi,\n        z = sin(phi),\n        k = z * cosDeltaPhi + x * sinDeltaPhi;\n    return [\n      atan2(y * cosDeltaGamma - k * sinDeltaGamma, x * cosDeltaPhi - z * sinDeltaPhi),\n      asin(k * cosDeltaGamma + y * sinDeltaGamma)\n    ];\n  }\n\n  rotation.invert = function(lambda, phi) {\n    var cosPhi = cos(phi),\n        x = cos(lambda) * cosPhi,\n        y = sin(lambda) * cosPhi,\n        z = sin(phi),\n        k = z * cosDeltaGamma - y * sinDeltaGamma;\n    return [\n      atan2(y * cosDeltaGamma + z * sinDeltaGamma, x * cosDeltaPhi + k * sinDeltaPhi),\n      asin(k * cosDeltaPhi - x * sinDeltaPhi)\n    ];\n  };\n\n  return rotation;\n}\n\nexport default function(rotate) {\n  rotate = rotateRadians(rotate[0] * radians, rotate[1] * radians, rotate.length > 2 ? rotate[2] * radians : 0);\n\n  function forward(coordinates) {\n    coordinates = rotate(coordinates[0] * radians, coordinates[1] * radians);\n    return coordinates[0] *= degrees, coordinates[1] *= degrees, coordinates;\n  }\n\n  forward.invert = function(coordinates) {\n    coordinates = rotate.invert(coordinates[0] * radians, coordinates[1] * radians);\n    return coordinates[0] *= degrees, coordinates[1] *= degrees, coordinates;\n  };\n\n  return forward;\n}\n", "import {cartesian, cartesianNormalizeInPlace, spherical} from \"./cartesian.js\";\nimport constant from \"./constant.js\";\nimport {acos, cos, degrees, epsilon, radians, sin, tau} from \"./math.js\";\nimport {rotateRadians} from \"./rotation.js\";\n\n// Generates a circle centered at [0\u00B0, 0\u00B0], with a given radius and precision.\nexport function circleStream(stream, radius, delta, direction, t0, t1) {\n  if (!delta) return;\n  var cosRadius = cos(radius),\n      sinRadius = sin(radius),\n      step = direction * delta;\n  if (t0 == null) {\n    t0 = radius + direction * tau;\n    t1 = radius - step / 2;\n  } else {\n    t0 = circleRadius(cosRadius, t0);\n    t1 = circleRadius(cosRadius, t1);\n    if (direction > 0 ? t0 < t1 : t0 > t1) t0 += direction * tau;\n  }\n  for (var point, t = t0; direction > 0 ? t > t1 : t < t1; t -= step) {\n    point = spherical([cosRadius, -sinRadius * cos(t), -sinRadius * sin(t)]);\n    stream.point(point[0], point[1]);\n  }\n}\n\n// Returns the signed angle of a cartesian point relative to [cosRadius, 0, 0].\nfunction circleRadius(cosRadius, point) {\n  point = cartesian(point), point[0] -= cosRadius;\n  cartesianNormalizeInPlace(point);\n  var radius = acos(-point[1]);\n  return ((-point[2] < 0 ? -radius : radius) + tau - epsilon) % tau;\n}\n\nexport default function() {\n  var center = constant([0, 0]),\n      radius = constant(90),\n      precision = constant(2),\n      ring,\n      rotate,\n      stream = {point: point};\n\n  function point(x, y) {\n    ring.push(x = rotate(x, y));\n    x[0] *= degrees, x[1] *= degrees;\n  }\n\n  function circle() {\n    var c = center.apply(this, arguments),\n        r = radius.apply(this, arguments) * radians,\n        p = precision.apply(this, arguments) * radians;\n    ring = [];\n    rotate = rotateRadians(-c[0] * radians, -c[1] * radians, 0).invert;\n    circleStream(stream, r, p, 1);\n    c = {type: \"Polygon\", coordinates: [ring]};\n    ring = rotate = null;\n    return c;\n  }\n\n  circle.center = function(_) {\n    return arguments.length ? (center = typeof _ === \"function\" ? _ : constant([+_[0], +_[1]]), circle) : center;\n  };\n\n  circle.radius = function(_) {\n    return arguments.length ? (radius = typeof _ === \"function\" ? _ : constant(+_), circle) : radius;\n  };\n\n  circle.precision = function(_) {\n    return arguments.length ? (precision = typeof _ === \"function\" ? _ : constant(+_), circle) : precision;\n  };\n\n  return circle;\n}\n", "import noop from \"../noop.js\";\n\nexport default function() {\n  var lines = [],\n      line;\n  return {\n    point: function(x, y, m) {\n      line.push([x, y, m]);\n    },\n    lineStart: function() {\n      lines.push(line = []);\n    },\n    lineEnd: noop,\n    rejoin: function() {\n      if (lines.length > 1) lines.push(lines.pop().concat(lines.shift()));\n    },\n    result: function() {\n      var result = lines;\n      lines = [];\n      line = null;\n      return result;\n    }\n  };\n}\n", "import {abs, epsilon} from \"./math.js\";\n\nexport default function(a, b) {\n  return abs(a[0] - b[0]) < epsilon && abs(a[1] - b[1]) < epsilon;\n}\n", "import pointEqual from \"../pointEqual.js\";\nimport {epsilon} from \"../math.js\";\n\nfunction Intersection(point, points, other, entry) {\n  this.x = point;\n  this.z = points;\n  this.o = other; // another intersection\n  this.e = entry; // is an entry?\n  this.v = false; // visited\n  this.n = this.p = null; // next & previous\n}\n\n// A generalized polygon clipping algorithm: given a polygon that has been cut\n// into its visible line segments, and rejoins the segments by interpolating\n// along the clip edge.\nexport default function(segments, compareIntersection, startInside, interpolate, stream) {\n  var subject = [],\n      clip = [],\n      i,\n      n;\n\n  segments.forEach(function(segment) {\n    if ((n = segment.length - 1) <= 0) return;\n    var n, p0 = segment[0], p1 = segment[n], x;\n\n    if (pointEqual(p0, p1)) {\n      if (!p0[2] && !p1[2]) {\n        stream.lineStart();\n        for (i = 0; i < n; ++i) stream.point((p0 = segment[i])[0], p0[1]);\n        stream.lineEnd();\n        return;\n      }\n      // handle degenerate cases by moving the point\n      p1[0] += 2 * epsilon;\n    }\n\n    subject.push(x = new Intersection(p0, segment, null, true));\n    clip.push(x.o = new Intersection(p0, null, x, false));\n    subject.push(x = new Intersection(p1, segment, null, false));\n    clip.push(x.o = new Intersection(p1, null, x, true));\n  });\n\n  if (!subject.length) return;\n\n  clip.sort(compareIntersection);\n  link(subject);\n  link(clip);\n\n  for (i = 0, n = clip.length; i < n; ++i) {\n    clip[i].e = startInside = !startInside;\n  }\n\n  var start = subject[0],\n      points,\n      point;\n\n  while (1) {\n    // Find first unvisited intersection.\n    var current = start,\n        isSubject = true;\n    while (current.v) if ((current = current.n) === start) return;\n    points = current.z;\n    stream.lineStart();\n    do {\n      current.v = current.o.v = true;\n      if (current.e) {\n        if (isSubject) {\n          for (i = 0, n = points.length; i < n; ++i) stream.point((point = points[i])[0], point[1]);\n        } else {\n          interpolate(current.x, current.n.x, 1, stream);\n        }\n        current = current.n;\n      } else {\n        if (isSubject) {\n          points = current.p.z;\n          for (i = points.length - 1; i >= 0; --i) stream.point((point = points[i])[0], point[1]);\n        } else {\n          interpolate(current.x, current.p.x, -1, stream);\n        }\n        current = current.p;\n      }\n      current = current.o;\n      points = current.z;\n      isSubject = !isSubject;\n    } while (!current.v);\n    stream.lineEnd();\n  }\n}\n\nfunction link(array) {\n  if (!(n = array.length)) return;\n  var n,\n      i = 0,\n      a = array[0],\n      b;\n  while (++i < n) {\n    a.n = b = array[i];\n    b.p = a;\n    a = b;\n  }\n  a.n = b = array[0];\n  b.p = a;\n}\n", "import {Adder} from \"d3-array\";\nimport {cartesian, cartesianCross, cartesianNormalizeInPlace} from \"./cartesian.js\";\nimport {abs, asin, atan2, cos, epsilon, epsilon2, halfPi, pi, quarterPi, sign, sin, tau} from \"./math.js\";\n\nfunction longitude(point) {\n  return abs(point[0]) <= pi ? point[0] : sign(point[0]) * ((abs(point[0]) + pi) % tau - pi);\n}\n\nexport default function(polygon, point) {\n  var lambda = longitude(point),\n      phi = point[1],\n      sinPhi = sin(phi),\n      normal = [sin(lambda), -cos(lambda), 0],\n      angle = 0,\n      winding = 0;\n\n  var sum = new Adder();\n\n  if (sinPhi === 1) phi = halfPi + epsilon;\n  else if (sinPhi === -1) phi = -halfPi - epsilon;\n\n  for (var i = 0, n = polygon.length; i < n; ++i) {\n    if (!(m = (ring = polygon[i]).length)) continue;\n    var ring,\n        m,\n        point0 = ring[m - 1],\n        lambda0 = longitude(point0),\n        phi0 = point0[1] / 2 + quarterPi,\n        sinPhi0 = sin(phi0),\n        cosPhi0 = cos(phi0);\n\n    for (var j = 0; j < m; ++j, lambda0 = lambda1, sinPhi0 = sinPhi1, cosPhi0 = cosPhi1, point0 = point1) {\n      var point1 = ring[j],\n          lambda1 = longitude(point1),\n          phi1 = point1[1] / 2 + quarterPi,\n          sinPhi1 = sin(phi1),\n          cosPhi1 = cos(phi1),\n          delta = lambda1 - lambda0,\n          sign = delta >= 0 ? 1 : -1,\n          absDelta = sign * delta,\n          antimeridian = absDelta > pi,\n          k = sinPhi0 * sinPhi1;\n\n      sum.add(atan2(k * sign * sin(absDelta), cosPhi0 * cosPhi1 + k * cos(absDelta)));\n      angle += antimeridian ? delta + sign * tau : delta;\n\n      // Are the longitudes either side of the point\u2019s meridian (lambda),\n      // and are the latitudes smaller than the parallel (phi)?\n      if (antimeridian ^ lambda0 >= lambda ^ lambda1 >= lambda) {\n        var arc = cartesianCross(cartesian(point0), cartesian(point1));\n        cartesianNormalizeInPlace(arc);\n        var intersection = cartesianCross(normal, arc);\n        cartesianNormalizeInPlace(intersection);\n        var phiArc = (antimeridian ^ delta >= 0 ? -1 : 1) * asin(intersection[2]);\n        if (phi > phiArc || phi === phiArc && (arc[0] || arc[1])) {\n          winding += antimeridian ^ delta >= 0 ? 1 : -1;\n        }\n      }\n    }\n  }\n\n  // First, determine whether the South pole is inside or outside:\n  //\n  // It is inside if:\n  // * the polygon winds around it in a clockwise direction.\n  // * the polygon does not (cumulatively) wind around it, but has a negative\n  //   (counter-clockwise) area.\n  //\n  // Second, count the (signed) number of times a segment crosses a lambda\n  // from the point to the South pole.  If it is zero, then the point is the\n  // same side as the South pole.\n\n  return (angle < -epsilon || angle < epsilon && sum < -epsilon2) ^ (winding & 1);\n}\n", "import clipBuffer from \"./buffer.js\";\nimport clipRejoin from \"./rejoin.js\";\nimport {epsilon, halfPi} from \"../math.js\";\nimport polygonContains from \"../polygonContains.js\";\nimport {merge} from \"d3-array\";\n\nexport default function(pointVisible, clipLine, interpolate, start) {\n  return function(sink) {\n    var line = clipLine(sink),\n        ringBuffer = clipBuffer(),\n        ringSink = clipLine(ringBuffer),\n        polygonStarted = false,\n        polygon,\n        segments,\n        ring;\n\n    var clip = {\n      point: point,\n      lineStart: lineStart,\n      lineEnd: lineEnd,\n      polygonStart: function() {\n        clip.point = pointRing;\n        clip.lineStart = ringStart;\n        clip.lineEnd = ringEnd;\n        segments = [];\n        polygon = [];\n      },\n      polygonEnd: function() {\n        clip.point = point;\n        clip.lineStart = lineStart;\n        clip.lineEnd = lineEnd;\n        segments = merge(segments);\n        var startInside = polygonContains(polygon, start);\n        if (segments.length) {\n          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;\n          clipRejoin(segments, compareIntersection, startInside, interpolate, sink);\n        } else if (startInside) {\n          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;\n          sink.lineStart();\n          interpolate(null, null, 1, sink);\n          sink.lineEnd();\n        }\n        if (polygonStarted) sink.polygonEnd(), polygonStarted = false;\n        segments = polygon = null;\n      },\n      sphere: function() {\n        sink.polygonStart();\n        sink.lineStart();\n        interpolate(null, null, 1, sink);\n        sink.lineEnd();\n        sink.polygonEnd();\n      }\n    };\n\n    function point(lambda, phi) {\n      if (pointVisible(lambda, phi)) sink.point(lambda, phi);\n    }\n\n    function pointLine(lambda, phi) {\n      line.point(lambda, phi);\n    }\n\n    function lineStart() {\n      clip.point = pointLine;\n      line.lineStart();\n    }\n\n    function lineEnd() {\n      clip.point = point;\n      line.lineEnd();\n    }\n\n    function pointRing(lambda, phi) {\n      ring.push([lambda, phi]);\n      ringSink.point(lambda, phi);\n    }\n\n    function ringStart() {\n      ringSink.lineStart();\n      ring = [];\n    }\n\n    function ringEnd() {\n      pointRing(ring[0][0], ring[0][1]);\n      ringSink.lineEnd();\n\n      var clean = ringSink.clean(),\n          ringSegments = ringBuffer.result(),\n          i, n = ringSegments.length, m,\n          segment,\n          point;\n\n      ring.pop();\n      polygon.push(ring);\n      ring = null;\n\n      if (!n) return;\n\n      // No intersections.\n      if (clean & 1) {\n        segment = ringSegments[0];\n        if ((m = segment.length - 1) > 0) {\n          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;\n          sink.lineStart();\n          for (i = 0; i < m; ++i) sink.point((point = segment[i])[0], point[1]);\n          sink.lineEnd();\n        }\n        return;\n      }\n\n      // Rejoin connected segments.\n      // TODO reuse ringBuffer.rejoin()?\n      if (n > 1 && clean & 2) ringSegments.push(ringSegments.pop().concat(ringSegments.shift()));\n\n      segments.push(ringSegments.filter(validSegment));\n    }\n\n    return clip;\n  };\n}\n\nfunction validSegment(segment) {\n  return segment.length > 1;\n}\n\n// Intersections are sorted along the clip edge. For both antimeridian cutting\n// and circle clipping, the same comparison is used.\nfunction compareIntersection(a, b) {\n  return ((a = a.x)[0] < 0 ? a[1] - halfPi - epsilon : halfPi - a[1])\n       - ((b = b.x)[0] < 0 ? b[1] - halfPi - epsilon : halfPi - b[1]);\n}\n", "import clip from \"./index.js\";\nimport {abs, atan, cos, epsilon, halfPi, pi, sin} from \"../math.js\";\n\nexport default clip(\n  function() { return true; },\n  clipAntimeridianLine,\n  clipAntimeridianInterpolate,\n  [-pi, -halfPi]\n);\n\n// Takes a line and cuts into visible segments. Return values: 0 - there were\n// intersections or the line was empty; 1 - no intersections; 2 - there were\n// intersections, and the first and last segments should be rejoined.\nfunction clipAntimeridianLine(stream) {\n  var lambda0 = NaN,\n      phi0 = NaN,\n      sign0 = NaN,\n      clean; // no intersections\n\n  return {\n    lineStart: function() {\n      stream.lineStart();\n      clean = 1;\n    },\n    point: function(lambda1, phi1) {\n      var sign1 = lambda1 > 0 ? pi : -pi,\n          delta = abs(lambda1 - lambda0);\n      if (abs(delta - pi) < epsilon) { // line crosses a pole\n        stream.point(lambda0, phi0 = (phi0 + phi1) / 2 > 0 ? halfPi : -halfPi);\n        stream.point(sign0, phi0);\n        stream.lineEnd();\n        stream.lineStart();\n        stream.point(sign1, phi0);\n        stream.point(lambda1, phi0);\n        clean = 0;\n      } else if (sign0 !== sign1 && delta >= pi) { // line crosses antimeridian\n        if (abs(lambda0 - sign0) < epsilon) lambda0 -= sign0 * epsilon; // handle degeneracies\n        if (abs(lambda1 - sign1) < epsilon) lambda1 -= sign1 * epsilon;\n        phi0 = clipAntimeridianIntersect(lambda0, phi0, lambda1, phi1);\n        stream.point(sign0, phi0);\n        stream.lineEnd();\n        stream.lineStart();\n        stream.point(sign1, phi0);\n        clean = 0;\n      }\n      stream.point(lambda0 = lambda1, phi0 = phi1);\n      sign0 = sign1;\n    },\n    lineEnd: function() {\n      stream.lineEnd();\n      lambda0 = phi0 = NaN;\n    },\n    clean: function() {\n      return 2 - clean; // if intersections, rejoin first and last segments\n    }\n  };\n}\n\nfunction clipAntimeridianIntersect(lambda0, phi0, lambda1, phi1) {\n  var cosPhi0,\n      cosPhi1,\n      sinLambda0Lambda1 = sin(lambda0 - lambda1);\n  return abs(sinLambda0Lambda1) > epsilon\n      ? atan((sin(phi0) * (cosPhi1 = cos(phi1)) * sin(lambda1)\n          - sin(phi1) * (cosPhi0 = cos(phi0)) * sin(lambda0))\n          / (cosPhi0 * cosPhi1 * sinLambda0Lambda1))\n      : (phi0 + phi1) / 2;\n}\n\nfunction clipAntimeridianInterpolate(from, to, direction, stream) {\n  var phi;\n  if (from == null) {\n    phi = direction * halfPi;\n    stream.point(-pi, phi);\n    stream.point(0, phi);\n    stream.point(pi, phi);\n    stream.point(pi, 0);\n    stream.point(pi, -phi);\n    stream.point(0, -phi);\n    stream.point(-pi, -phi);\n    stream.point(-pi, 0);\n    stream.point(-pi, phi);\n  } else if (abs(from[0] - to[0]) > epsilon) {\n    var lambda = from[0] < to[0] ? pi : -pi;\n    phi = direction * lambda / 2;\n    stream.point(-lambda, phi);\n    stream.point(0, phi);\n    stream.point(lambda, phi);\n  } else {\n    stream.point(to[0], to[1]);\n  }\n}\n", "import {cartesian, cartesianAddInPlace, cartesianCross, cartesianDot, cartesianScale, spherical} from \"../cartesian.js\";\nimport {circleStream} from \"../circle.js\";\nimport {abs, cos, epsilon, pi, radians, sqrt} from \"../math.js\";\nimport pointEqual from \"../pointEqual.js\";\nimport clip from \"./index.js\";\n\nexport default function(radius) {\n  var cr = cos(radius),\n      delta = 2 * radians,\n      smallRadius = cr > 0,\n      notHemisphere = abs(cr) > epsilon; // TODO optimise for this common case\n\n  function interpolate(from, to, direction, stream) {\n    circleStream(stream, radius, delta, direction, from, to);\n  }\n\n  function visible(lambda, phi) {\n    return cos(lambda) * cos(phi) > cr;\n  }\n\n  // Takes a line and cuts into visible segments. Return values used for polygon\n  // clipping: 0 - there were intersections or the line was empty; 1 - no\n  // intersections 2 - there were intersections, and the first and last segments\n  // should be rejoined.\n  function clipLine(stream) {\n    var point0, // previous point\n        c0, // code for previous point\n        v0, // visibility of previous point\n        v00, // visibility of first point\n        clean; // no intersections\n    return {\n      lineStart: function() {\n        v00 = v0 = false;\n        clean = 1;\n      },\n      point: function(lambda, phi) {\n        var point1 = [lambda, phi],\n            point2,\n            v = visible(lambda, phi),\n            c = smallRadius\n              ? v ? 0 : code(lambda, phi)\n              : v ? code(lambda + (lambda < 0 ? pi : -pi), phi) : 0;\n        if (!point0 && (v00 = v0 = v)) stream.lineStart();\n        if (v !== v0) {\n          point2 = intersect(point0, point1);\n          if (!point2 || pointEqual(point0, point2) || pointEqual(point1, point2))\n            point1[2] = 1;\n        }\n        if (v !== v0) {\n          clean = 0;\n          if (v) {\n            // outside going in\n            stream.lineStart();\n            point2 = intersect(point1, point0);\n            stream.point(point2[0], point2[1]);\n          } else {\n            // inside going out\n            point2 = intersect(point0, point1);\n            stream.point(point2[0], point2[1], 2);\n            stream.lineEnd();\n          }\n          point0 = point2;\n        } else if (notHemisphere && point0 && smallRadius ^ v) {\n          var t;\n          // If the codes for two points are different, or are both zero,\n          // and there this segment intersects with the small circle.\n          if (!(c & c0) && (t = intersect(point1, point0, true))) {\n            clean = 0;\n            if (smallRadius) {\n              stream.lineStart();\n              stream.point(t[0][0], t[0][1]);\n              stream.point(t[1][0], t[1][1]);\n              stream.lineEnd();\n            } else {\n              stream.point(t[1][0], t[1][1]);\n              stream.lineEnd();\n              stream.lineStart();\n              stream.point(t[0][0], t[0][1], 3);\n            }\n          }\n        }\n        if (v && (!point0 || !pointEqual(point0, point1))) {\n          stream.point(point1[0], point1[1]);\n        }\n        point0 = point1, v0 = v, c0 = c;\n      },\n      lineEnd: function() {\n        if (v0) stream.lineEnd();\n        point0 = null;\n      },\n      // Rejoin first and last segments if there were intersections and the first\n      // and last points were visible.\n      clean: function() {\n        return clean | ((v00 && v0) << 1);\n      }\n    };\n  }\n\n  // Intersects the great circle between a and b with the clip circle.\n  function intersect(a, b, two) {\n    var pa = cartesian(a),\n        pb = cartesian(b);\n\n    // We have two planes, n1.p = d1 and n2.p = d2.\n    // Find intersection line p(t) = c1 n1 + c2 n2 + t (n1 \u2A2F n2).\n    var n1 = [1, 0, 0], // normal\n        n2 = cartesianCross(pa, pb),\n        n2n2 = cartesianDot(n2, n2),\n        n1n2 = n2[0], // cartesianDot(n1, n2),\n        determinant = n2n2 - n1n2 * n1n2;\n\n    // Two polar points.\n    if (!determinant) return !two && a;\n\n    var c1 =  cr * n2n2 / determinant,\n        c2 = -cr * n1n2 / determinant,\n        n1xn2 = cartesianCross(n1, n2),\n        A = cartesianScale(n1, c1),\n        B = cartesianScale(n2, c2);\n    cartesianAddInPlace(A, B);\n\n    // Solve |p(t)|^2 = 1.\n    var u = n1xn2,\n        w = cartesianDot(A, u),\n        uu = cartesianDot(u, u),\n        t2 = w * w - uu * (cartesianDot(A, A) - 1);\n\n    if (t2 < 0) return;\n\n    var t = sqrt(t2),\n        q = cartesianScale(u, (-w - t) / uu);\n    cartesianAddInPlace(q, A);\n    q = spherical(q);\n\n    if (!two) return q;\n\n    // Two intersection points.\n    var lambda0 = a[0],\n        lambda1 = b[0],\n        phi0 = a[1],\n        phi1 = b[1],\n        z;\n\n    if (lambda1 < lambda0) z = lambda0, lambda0 = lambda1, lambda1 = z;\n\n    var delta = lambda1 - lambda0,\n        polar = abs(delta - pi) < epsilon,\n        meridian = polar || delta < epsilon;\n\n    if (!polar && phi1 < phi0) z = phi0, phi0 = phi1, phi1 = z;\n\n    // Check that the first point is between a and b.\n    if (meridian\n        ? polar\n          ? phi0 + phi1 > 0 ^ q[1] < (abs(q[0] - lambda0) < epsilon ? phi0 : phi1)\n          : phi0 <= q[1] && q[1] <= phi1\n        : delta > pi ^ (lambda0 <= q[0] && q[0] <= lambda1)) {\n      var q1 = cartesianScale(u, (-w + t) / uu);\n      cartesianAddInPlace(q1, A);\n      return [q, spherical(q1)];\n    }\n  }\n\n  // Generates a 4-bit vector representing the location of a point relative to\n  // the small circle's bounding box.\n  function code(lambda, phi) {\n    var r = smallRadius ? radius : pi - radius,\n        code = 0;\n    if (lambda < -r) code |= 1; // left\n    else if (lambda > r) code |= 2; // right\n    if (phi < -r) code |= 4; // below\n    else if (phi > r) code |= 8; // above\n    return code;\n  }\n\n  return clip(visible, clipLine, interpolate, smallRadius ? [0, -radius] : [-pi, radius - pi]);\n}\n", "export default function(a, b, x0, y0, x1, y1) {\n  var ax = a[0],\n      ay = a[1],\n      bx = b[0],\n      by = b[1],\n      t0 = 0,\n      t1 = 1,\n      dx = bx - ax,\n      dy = by - ay,\n      r;\n\n  r = x0 - ax;\n  if (!dx && r > 0) return;\n  r /= dx;\n  if (dx < 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  } else if (dx > 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  }\n\n  r = x1 - ax;\n  if (!dx && r < 0) return;\n  r /= dx;\n  if (dx < 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  } else if (dx > 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  }\n\n  r = y0 - ay;\n  if (!dy && r > 0) return;\n  r /= dy;\n  if (dy < 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  } else if (dy > 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  }\n\n  r = y1 - ay;\n  if (!dy && r < 0) return;\n  r /= dy;\n  if (dy < 0) {\n    if (r > t1) return;\n    if (r > t0) t0 = r;\n  } else if (dy > 0) {\n    if (r < t0) return;\n    if (r < t1) t1 = r;\n  }\n\n  if (t0 > 0) a[0] = ax + t0 * dx, a[1] = ay + t0 * dy;\n  if (t1 < 1) b[0] = ax + t1 * dx, b[1] = ay + t1 * dy;\n  return true;\n}\n", "import {abs, epsilon} from \"../math.js\";\nimport clipBuffer from \"./buffer.js\";\nimport clipLine from \"./line.js\";\nimport clipRejoin from \"./rejoin.js\";\nimport {merge} from \"d3-array\";\n\nvar clipMax = 1e9, clipMin = -clipMax;\n\n// TODO Use d3-polygon\u2019s polygonContains here for the ring check?\n// TODO Eliminate duplicate buffering in clipBuffer and polygon.push?\n\nexport default function clipRectangle(x0, y0, x1, y1) {\n\n  function visible(x, y) {\n    return x0 <= x && x <= x1 && y0 <= y && y <= y1;\n  }\n\n  function interpolate(from, to, direction, stream) {\n    var a = 0, a1 = 0;\n    if (from == null\n        || (a = corner(from, direction)) !== (a1 = corner(to, direction))\n        || comparePoint(from, to) < 0 ^ direction > 0) {\n      do stream.point(a === 0 || a === 3 ? x0 : x1, a > 1 ? y1 : y0);\n      while ((a = (a + direction + 4) % 4) !== a1);\n    } else {\n      stream.point(to[0], to[1]);\n    }\n  }\n\n  function corner(p, direction) {\n    return abs(p[0] - x0) < epsilon ? direction > 0 ? 0 : 3\n        : abs(p[0] - x1) < epsilon ? direction > 0 ? 2 : 1\n        : abs(p[1] - y0) < epsilon ? direction > 0 ? 1 : 0\n        : direction > 0 ? 3 : 2; // abs(p[1] - y1) < epsilon\n  }\n\n  function compareIntersection(a, b) {\n    return comparePoint(a.x, b.x);\n  }\n\n  function comparePoint(a, b) {\n    var ca = corner(a, 1),\n        cb = corner(b, 1);\n    return ca !== cb ? ca - cb\n        : ca === 0 ? b[1] - a[1]\n        : ca === 1 ? a[0] - b[0]\n        : ca === 2 ? a[1] - b[1]\n        : b[0] - a[0];\n  }\n\n  return function(stream) {\n    var activeStream = stream,\n        bufferStream = clipBuffer(),\n        segments,\n        polygon,\n        ring,\n        x__, y__, v__, // first point\n        x_, y_, v_, // previous point\n        first,\n        clean;\n\n    var clipStream = {\n      point: point,\n      lineStart: lineStart,\n      lineEnd: lineEnd,\n      polygonStart: polygonStart,\n      polygonEnd: polygonEnd\n    };\n\n    function point(x, y) {\n      if (visible(x, y)) activeStream.point(x, y);\n    }\n\n    function polygonInside() {\n      var winding = 0;\n\n      for (var i = 0, n = polygon.length; i < n; ++i) {\n        for (var ring = polygon[i], j = 1, m = ring.length, point = ring[0], a0, a1, b0 = point[0], b1 = point[1]; j < m; ++j) {\n          a0 = b0, a1 = b1, point = ring[j], b0 = point[0], b1 = point[1];\n          if (a1 <= y1) { if (b1 > y1 && (b0 - a0) * (y1 - a1) > (b1 - a1) * (x0 - a0)) ++winding; }\n          else { if (b1 <= y1 && (b0 - a0) * (y1 - a1) < (b1 - a1) * (x0 - a0)) --winding; }\n        }\n      }\n\n      return winding;\n    }\n\n    // Buffer geometry within a polygon and then clip it en masse.\n    function polygonStart() {\n      activeStream = bufferStream, segments = [], polygon = [], clean = true;\n    }\n\n    function polygonEnd() {\n      var startInside = polygonInside(),\n          cleanInside = clean && startInside,\n          visible = (segments = merge(segments)).length;\n      if (cleanInside || visible) {\n        stream.polygonStart();\n        if (cleanInside) {\n          stream.lineStart();\n          interpolate(null, null, 1, stream);\n          stream.lineEnd();\n        }\n        if (visible) {\n          clipRejoin(segments, compareIntersection, startInside, interpolate, stream);\n        }\n        stream.polygonEnd();\n      }\n      activeStream = stream, segments = polygon = ring = null;\n    }\n\n    function lineStart() {\n      clipStream.point = linePoint;\n      if (polygon) polygon.push(ring = []);\n      first = true;\n      v_ = false;\n      x_ = y_ = NaN;\n    }\n\n    // TODO rather than special-case polygons, simply handle them separately.\n    // Ideally, coincident intersection points should be jittered to avoid\n    // clipping issues.\n    function lineEnd() {\n      if (segments) {\n        linePoint(x__, y__);\n        if (v__ && v_) bufferStream.rejoin();\n        segments.push(bufferStream.result());\n      }\n      clipStream.point = point;\n      if (v_) activeStream.lineEnd();\n    }\n\n    function linePoint(x, y) {\n      var v = visible(x, y);\n      if (polygon) ring.push([x, y]);\n      if (first) {\n        x__ = x, y__ = y, v__ = v;\n        first = false;\n        if (v) {\n          activeStream.lineStart();\n          activeStream.point(x, y);\n        }\n      } else {\n        if (v && v_) activeStream.point(x, y);\n        else {\n          var a = [x_ = Math.max(clipMin, Math.min(clipMax, x_)), y_ = Math.max(clipMin, Math.min(clipMax, y_))],\n              b = [x = Math.max(clipMin, Math.min(clipMax, x)), y = Math.max(clipMin, Math.min(clipMax, y))];\n          if (clipLine(a, b, x0, y0, x1, y1)) {\n            if (!v_) {\n              activeStream.lineStart();\n              activeStream.point(a[0], a[1]);\n            }\n            activeStream.point(b[0], b[1]);\n            if (!v) activeStream.lineEnd();\n            clean = false;\n          } else if (v) {\n            activeStream.lineStart();\n            activeStream.point(x, y);\n            clean = false;\n          }\n        }\n      }\n      x_ = x, y_ = y, v_ = v;\n    }\n\n    return clipStream;\n  };\n}\n", "export default x => x;\n", "import {Adder} from \"d3-array\";\nimport {abs} from \"../math.js\";\nimport noop from \"../noop.js\";\n\nvar areaSum = new Adder(),\n    areaRingSum = new Adder(),\n    x00,\n    y00,\n    x0,\n    y0;\n\nvar areaStream = {\n  point: noop,\n  lineStart: noop,\n  lineEnd: noop,\n  polygonStart: function() {\n    areaStream.lineStart = areaRingStart;\n    areaStream.lineEnd = areaRingEnd;\n  },\n  polygonEnd: function() {\n    areaStream.lineStart = areaStream.lineEnd = areaStream.point = noop;\n    areaSum.add(abs(areaRingSum));\n    areaRingSum = new Adder();\n  },\n  result: function() {\n    var area = areaSum / 2;\n    areaSum = new Adder();\n    return area;\n  }\n};\n\nfunction areaRingStart() {\n  areaStream.point = areaPointFirst;\n}\n\nfunction areaPointFirst(x, y) {\n  areaStream.point = areaPoint;\n  x00 = x0 = x, y00 = y0 = y;\n}\n\nfunction areaPoint(x, y) {\n  areaRingSum.add(y0 * x - x0 * y);\n  x0 = x, y0 = y;\n}\n\nfunction areaRingEnd() {\n  areaPoint(x00, y00);\n}\n\nexport default areaStream;\n", "import noop from \"../noop.js\";\n\nvar x0 = Infinity,\n    y0 = x0,\n    x1 = -x0,\n    y1 = x1;\n\nvar boundsStream = {\n  point: boundsPoint,\n  lineStart: noop,\n  lineEnd: noop,\n  polygonStart: noop,\n  polygonEnd: noop,\n  result: function() {\n    var bounds = [[x0, y0], [x1, y1]];\n    x1 = y1 = -(y0 = x0 = Infinity);\n    return bounds;\n  }\n};\n\nfunction boundsPoint(x, y) {\n  if (x < x0) x0 = x;\n  if (x > x1) x1 = x;\n  if (y < y0) y0 = y;\n  if (y > y1) y1 = y;\n}\n\nexport default boundsStream;\n", "import {sqrt} from \"../math.js\";\n\n// TODO Enforce positive area for exterior, negative area for interior?\n\nvar X0 = 0,\n    Y0 = 0,\n    Z0 = 0,\n    X1 = 0,\n    Y1 = 0,\n    Z1 = 0,\n    X2 = 0,\n    Y2 = 0,\n    Z2 = 0,\n    x00,\n    y00,\n    x0,\n    y0;\n\nvar centroidStream = {\n  point: centroidPoint,\n  lineStart: centroidLineStart,\n  lineEnd: centroidLineEnd,\n  polygonStart: function() {\n    centroidStream.lineStart = centroidRingStart;\n    centroidStream.lineEnd = centroidRingEnd;\n  },\n  polygonEnd: function() {\n    centroidStream.point = centroidPoint;\n    centroidStream.lineStart = centroidLineStart;\n    centroidStream.lineEnd = centroidLineEnd;\n  },\n  result: function() {\n    var centroid = Z2 ? [X2 / Z2, Y2 / Z2]\n        : Z1 ? [X1 / Z1, Y1 / Z1]\n        : Z0 ? [X0 / Z0, Y0 / Z0]\n        : [NaN, NaN];\n    X0 = Y0 = Z0 =\n    X1 = Y1 = Z1 =\n    X2 = Y2 = Z2 = 0;\n    return centroid;\n  }\n};\n\nfunction centroidPoint(x, y) {\n  X0 += x;\n  Y0 += y;\n  ++Z0;\n}\n\nfunction centroidLineStart() {\n  centroidStream.point = centroidPointFirstLine;\n}\n\nfunction centroidPointFirstLine(x, y) {\n  centroidStream.point = centroidPointLine;\n  centroidPoint(x0 = x, y0 = y);\n}\n\nfunction centroidPointLine(x, y) {\n  var dx = x - x0, dy = y - y0, z = sqrt(dx * dx + dy * dy);\n  X1 += z * (x0 + x) / 2;\n  Y1 += z * (y0 + y) / 2;\n  Z1 += z;\n  centroidPoint(x0 = x, y0 = y);\n}\n\nfunction centroidLineEnd() {\n  centroidStream.point = centroidPoint;\n}\n\nfunction centroidRingStart() {\n  centroidStream.point = centroidPointFirstRing;\n}\n\nfunction centroidRingEnd() {\n  centroidPointRing(x00, y00);\n}\n\nfunction centroidPointFirstRing(x, y) {\n  centroidStream.point = centroidPointRing;\n  centroidPoint(x00 = x0 = x, y00 = y0 = y);\n}\n\nfunction centroidPointRing(x, y) {\n  var dx = x - x0,\n      dy = y - y0,\n      z = sqrt(dx * dx + dy * dy);\n\n  X1 += z * (x0 + x) / 2;\n  Y1 += z * (y0 + y) / 2;\n  Z1 += z;\n\n  z = y0 * x - x0 * y;\n  X2 += z * (x0 + x);\n  Y2 += z * (y0 + y);\n  Z2 += z * 3;\n  centroidPoint(x0 = x, y0 = y);\n}\n\nexport default centroidStream;\n", "import {tau} from \"../math.js\";\nimport noop from \"../noop.js\";\n\nexport default function PathContext(context) {\n  this._context = context;\n}\n\nPathContext.prototype = {\n  _radius: 4.5,\n  pointRadius: function(_) {\n    return this._radius = _, this;\n  },\n  polygonStart: function() {\n    this._line = 0;\n  },\n  polygonEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line === 0) this._context.closePath();\n    this._point = NaN;\n  },\n  point: function(x, y) {\n    switch (this._point) {\n      case 0: {\n        this._context.moveTo(x, y);\n        this._point = 1;\n        break;\n      }\n      case 1: {\n        this._context.lineTo(x, y);\n        break;\n      }\n      default: {\n        this._context.moveTo(x + this._radius, y);\n        this._context.arc(x, y, this._radius, 0, tau);\n        break;\n      }\n    }\n  },\n  result: noop\n};\n", "import {Adder} from \"d3-array\";\nimport {sqrt} from \"../math.js\";\nimport noop from \"../noop.js\";\n\nvar lengthSum = new Adder(),\n    lengthRing,\n    x00,\n    y00,\n    x0,\n    y0;\n\nvar lengthStream = {\n  point: noop,\n  lineStart: function() {\n    lengthStream.point = lengthPointFirst;\n  },\n  lineEnd: function() {\n    if (lengthRing) lengthPoint(x00, y00);\n    lengthStream.point = noop;\n  },\n  polygonStart: function() {\n    lengthRing = true;\n  },\n  polygonEnd: function() {\n    lengthRing = null;\n  },\n  result: function() {\n    var length = +lengthSum;\n    lengthSum = new Adder();\n    return length;\n  }\n};\n\nfunction lengthPointFirst(x, y) {\n  lengthStream.point = lengthPoint;\n  x00 = x0 = x, y00 = y0 = y;\n}\n\nfunction lengthPoint(x, y) {\n  x0 -= x, y0 -= y;\n  lengthSum.add(sqrt(x0 * x0 + y0 * y0));\n  x0 = x, y0 = y;\n}\n\nexport default lengthStream;\n", "// Simple caching for constant-radius points.\nlet cacheDigits, cacheAppend, cacheRadius, cacheCircle;\n\nexport default class PathString {\n  constructor(digits) {\n    this._append = digits == null ? append : appendRound(digits);\n    this._radius = 4.5;\n    this._ = \"\";\n  }\n  pointRadius(_) {\n    this._radius = +_;\n    return this;\n  }\n  polygonStart() {\n    this._line = 0;\n  }\n  polygonEnd() {\n    this._line = NaN;\n  }\n  lineStart() {\n    this._point = 0;\n  }\n  lineEnd() {\n    if (this._line === 0) this._ += \"Z\";\n    this._point = NaN;\n  }\n  point(x, y) {\n    switch (this._point) {\n      case 0: {\n        this._append`M${x},${y}`;\n        this._point = 1;\n        break;\n      }\n      case 1: {\n        this._append`L${x},${y}`;\n        break;\n      }\n      default: {\n        this._append`M${x},${y}`;\n        if (this._radius !== cacheRadius || this._append !== cacheAppend) {\n          const r = this._radius;\n          const s = this._;\n          this._ = \"\"; // stash the old string so we can cache the circle path fragment\n          this._append`m0,${r}a${r},${r} 0 1,1 0,${-2 * r}a${r},${r} 0 1,1 0,${2 * r}z`;\n          cacheRadius = r;\n          cacheAppend = this._append;\n          cacheCircle = this._;\n          this._ = s;\n        }\n        this._ += cacheCircle;\n        break;\n      }\n    }\n  }\n  result() {\n    const result = this._;\n    this._ = \"\";\n    return result.length ? result : null;\n  }\n}\n\nfunction append(strings) {\n  let i = 1;\n  this._ += strings[0];\n  for (const j = strings.length; i < j; ++i) {\n    this._ += arguments[i] + strings[i];\n  }\n}\n\nfunction appendRound(digits) {\n  const d = Math.floor(digits);\n  if (!(d >= 0)) throw new RangeError(`invalid digits: ${digits}`);\n  if (d > 15) return append;\n  if (d !== cacheDigits) {\n    const k = 10 ** d;\n    cacheDigits = d;\n    cacheAppend = function append(strings) {\n      let i = 1;\n      this._ += strings[0];\n      for (const j = strings.length; i < j; ++i) {\n        this._ += Math.round(arguments[i] * k) / k + strings[i];\n      }\n    };\n  }\n  return cacheAppend;\n}\n", "import identity from \"../identity.js\";\nimport stream from \"../stream.js\";\nimport pathArea from \"./area.js\";\nimport pathBounds from \"./bounds.js\";\nimport pathCentroid from \"./centroid.js\";\nimport PathContext from \"./context.js\";\nimport pathMeasure from \"./measure.js\";\nimport PathString from \"./string.js\";\n\nexport default function(projection, context) {\n  let digits = 3,\n      pointRadius = 4.5,\n      projectionStream,\n      contextStream;\n\n  function path(object) {\n    if (object) {\n      if (typeof pointRadius === \"function\") contextStream.pointRadius(+pointRadius.apply(this, arguments));\n      stream(object, projectionStream(contextStream));\n    }\n    return contextStream.result();\n  }\n\n  path.area = function(object) {\n    stream(object, projectionStream(pathArea));\n    return pathArea.result();\n  };\n\n  path.measure = function(object) {\n    stream(object, projectionStream(pathMeasure));\n    return pathMeasure.result();\n  };\n\n  path.bounds = function(object) {\n    stream(object, projectionStream(pathBounds));\n    return pathBounds.result();\n  };\n\n  path.centroid = function(object) {\n    stream(object, projectionStream(pathCentroid));\n    return pathCentroid.result();\n  };\n\n  path.projection = function(_) {\n    if (!arguments.length) return projection;\n    projectionStream = _ == null ? (projection = null, identity) : (projection = _).stream;\n    return path;\n  };\n\n  path.context = function(_) {\n    if (!arguments.length) return context;\n    contextStream = _ == null ? (context = null, new PathString(digits)) : new PathContext(context = _);\n    if (typeof pointRadius !== \"function\") contextStream.pointRadius(pointRadius);\n    return path;\n  };\n\n  path.pointRadius = function(_) {\n    if (!arguments.length) return pointRadius;\n    pointRadius = typeof _ === \"function\" ? _ : (contextStream.pointRadius(+_), +_);\n    return path;\n  };\n\n  path.digits = function(_) {\n    if (!arguments.length) return digits;\n    if (_ == null) digits = null;\n    else {\n      const d = Math.floor(_);\n      if (!(d >= 0)) throw new RangeError(`invalid digits: ${_}`);\n      digits = d;\n    }\n    if (context === null) contextStream = new PathString(digits);\n    return path;\n  };\n\n  return path.projection(projection).digits(digits).context(context);\n}\n", "export default function(methods) {\n  return {\n    stream: transformer(methods)\n  };\n}\n\nexport function transformer(methods) {\n  return function(stream) {\n    var s = new TransformStream;\n    for (var key in methods) s[key] = methods[key];\n    s.stream = stream;\n    return s;\n  };\n}\n\nfunction TransformStream() {}\n\nTransformStream.prototype = {\n  constructor: TransformStream,\n  point: function(x, y) { this.stream.point(x, y); },\n  sphere: function() { this.stream.sphere(); },\n  lineStart: function() { this.stream.lineStart(); },\n  lineEnd: function() { this.stream.lineEnd(); },\n  polygonStart: function() { this.stream.polygonStart(); },\n  polygonEnd: function() { this.stream.polygonEnd(); }\n};\n", "import {default as geoStream} from \"../stream.js\";\nimport boundsStream from \"../path/bounds.js\";\n\nfunction fit(projection, fitBounds, object) {\n  var clip = projection.clipExtent && projection.clipExtent();\n  projection.scale(150).translate([0, 0]);\n  if (clip != null) projection.clipExtent(null);\n  geoStream(object, projection.stream(boundsStream));\n  fitBounds(boundsStream.result());\n  if (clip != null) projection.clipExtent(clip);\n  return projection;\n}\n\nexport function fitExtent(projection, extent, object) {\n  return fit(projection, function(b) {\n    var w = extent[1][0] - extent[0][0],\n        h = extent[1][1] - extent[0][1],\n        k = Math.min(w / (b[1][0] - b[0][0]), h / (b[1][1] - b[0][1])),\n        x = +extent[0][0] + (w - k * (b[1][0] + b[0][0])) / 2,\n        y = +extent[0][1] + (h - k * (b[1][1] + b[0][1])) / 2;\n    projection.scale(150 * k).translate([x, y]);\n  }, object);\n}\n\nexport function fitSize(projection, size, object) {\n  return fitExtent(projection, [[0, 0], size], object);\n}\n\nexport function fitWidth(projection, width, object) {\n  return fit(projection, function(b) {\n    var w = +width,\n        k = w / (b[1][0] - b[0][0]),\n        x = (w - k * (b[1][0] + b[0][0])) / 2,\n        y = -k * b[0][1];\n    projection.scale(150 * k).translate([x, y]);\n  }, object);\n}\n\nexport function fitHeight(projection, height, object) {\n  return fit(projection, function(b) {\n    var h = +height,\n        k = h / (b[1][1] - b[0][1]),\n        x = -k * b[0][0],\n        y = (h - k * (b[1][1] + b[0][1])) / 2;\n    projection.scale(150 * k).translate([x, y]);\n  }, object);\n}\n", "import {cartesian} from \"../cartesian.js\";\nimport {abs, asin, atan2, cos, epsilon, radians, sqrt} from \"../math.js\";\nimport {transformer} from \"../transform.js\";\n\nvar maxDepth = 16, // maximum depth of subdivision\n    cosMinDistance = cos(30 * radians); // cos(minimum angular distance)\n\nexport default function(project, delta2) {\n  return +delta2 ? resample(project, delta2) : resampleNone(project);\n}\n\nfunction resampleNone(project) {\n  return transformer({\n    point: function(x, y) {\n      x = project(x, y);\n      this.stream.point(x[0], x[1]);\n    }\n  });\n}\n\nfunction resample(project, delta2) {\n\n  function resampleLineTo(x0, y0, lambda0, a0, b0, c0, x1, y1, lambda1, a1, b1, c1, depth, stream) {\n    var dx = x1 - x0,\n        dy = y1 - y0,\n        d2 = dx * dx + dy * dy;\n    if (d2 > 4 * delta2 && depth--) {\n      var a = a0 + a1,\n          b = b0 + b1,\n          c = c0 + c1,\n          m = sqrt(a * a + b * b + c * c),\n          phi2 = asin(c /= m),\n          lambda2 = abs(abs(c) - 1) < epsilon || abs(lambda0 - lambda1) < epsilon ? (lambda0 + lambda1) / 2 : atan2(b, a),\n          p = project(lambda2, phi2),\n          x2 = p[0],\n          y2 = p[1],\n          dx2 = x2 - x0,\n          dy2 = y2 - y0,\n          dz = dy * dx2 - dx * dy2;\n      if (dz * dz / d2 > delta2 // perpendicular projected distance\n          || abs((dx * dx2 + dy * dy2) / d2 - 0.5) > 0.3 // midpoint close to an end\n          || a0 * a1 + b0 * b1 + c0 * c1 < cosMinDistance) { // angular distance\n        resampleLineTo(x0, y0, lambda0, a0, b0, c0, x2, y2, lambda2, a /= m, b /= m, c, depth, stream);\n        stream.point(x2, y2);\n        resampleLineTo(x2, y2, lambda2, a, b, c, x1, y1, lambda1, a1, b1, c1, depth, stream);\n      }\n    }\n  }\n  return function(stream) {\n    var lambda00, x00, y00, a00, b00, c00, // first point\n        lambda0, x0, y0, a0, b0, c0; // previous point\n\n    var resampleStream = {\n      point: point,\n      lineStart: lineStart,\n      lineEnd: lineEnd,\n      polygonStart: function() { stream.polygonStart(); resampleStream.lineStart = ringStart; },\n      polygonEnd: function() { stream.polygonEnd(); resampleStream.lineStart = lineStart; }\n    };\n\n    function point(x, y) {\n      x = project(x, y);\n      stream.point(x[0], x[1]);\n    }\n\n    function lineStart() {\n      x0 = NaN;\n      resampleStream.point = linePoint;\n      stream.lineStart();\n    }\n\n    function linePoint(lambda, phi) {\n      var c = cartesian([lambda, phi]), p = project(lambda, phi);\n      resampleLineTo(x0, y0, lambda0, a0, b0, c0, x0 = p[0], y0 = p[1], lambda0 = lambda, a0 = c[0], b0 = c[1], c0 = c[2], maxDepth, stream);\n      stream.point(x0, y0);\n    }\n\n    function lineEnd() {\n      resampleStream.point = point;\n      stream.lineEnd();\n    }\n\n    function ringStart() {\n      lineStart();\n      resampleStream.point = ringPoint;\n      resampleStream.lineEnd = ringEnd;\n    }\n\n    function ringPoint(lambda, phi) {\n      linePoint(lambda00 = lambda, phi), x00 = x0, y00 = y0, a00 = a0, b00 = b0, c00 = c0;\n      resampleStream.point = linePoint;\n    }\n\n    function ringEnd() {\n      resampleLineTo(x0, y0, lambda0, a0, b0, c0, x00, y00, lambda00, a00, b00, c00, maxDepth, stream);\n      resampleStream.lineEnd = lineEnd;\n      lineEnd();\n    }\n\n    return resampleStream;\n  };\n}\n", "import clipAntimeridian from \"../clip/antimeridian.js\";\nimport clipCircle from \"../clip/circle.js\";\nimport clipRectangle from \"../clip/rectangle.js\";\nimport compose from \"../compose.js\";\nimport identity from \"../identity.js\";\nimport {cos, degrees, radians, sin, sqrt} from \"../math.js\";\nimport {rotateRadians} from \"../rotation.js\";\nimport {transformer} from \"../transform.js\";\nimport {fitExtent, fitSize, fitWidth, fitHeight} from \"./fit.js\";\nimport resample from \"./resample.js\";\n\nvar transformRadians = transformer({\n  point: function(x, y) {\n    this.stream.point(x * radians, y * radians);\n  }\n});\n\nfunction transformRotate(rotate) {\n  return transformer({\n    point: function(x, y) {\n      var r = rotate(x, y);\n      return this.stream.point(r[0], r[1]);\n    }\n  });\n}\n\nfunction scaleTranslate(k, dx, dy, sx, sy) {\n  function transform(x, y) {\n    x *= sx; y *= sy;\n    return [dx + k * x, dy - k * y];\n  }\n  transform.invert = function(x, y) {\n    return [(x - dx) / k * sx, (dy - y) / k * sy];\n  };\n  return transform;\n}\n\nfunction scaleTranslateRotate(k, dx, dy, sx, sy, alpha) {\n  if (!alpha) return scaleTranslate(k, dx, dy, sx, sy);\n  var cosAlpha = cos(alpha),\n      sinAlpha = sin(alpha),\n      a = cosAlpha * k,\n      b = sinAlpha * k,\n      ai = cosAlpha / k,\n      bi = sinAlpha / k,\n      ci = (sinAlpha * dy - cosAlpha * dx) / k,\n      fi = (sinAlpha * dx + cosAlpha * dy) / k;\n  function transform(x, y) {\n    x *= sx; y *= sy;\n    return [a * x - b * y + dx, dy - b * x - a * y];\n  }\n  transform.invert = function(x, y) {\n    return [sx * (ai * x - bi * y + ci), sy * (fi - bi * x - ai * y)];\n  };\n  return transform;\n}\n\nexport default function projection(project) {\n  return projectionMutator(function() { return project; })();\n}\n\nexport function projectionMutator(projectAt) {\n  var project,\n      k = 150, // scale\n      x = 480, y = 250, // translate\n      lambda = 0, phi = 0, // center\n      deltaLambda = 0, deltaPhi = 0, deltaGamma = 0, rotate, // pre-rotate\n      alpha = 0, // post-rotate angle\n      sx = 1, // reflectX\n      sy = 1, // reflectX\n      theta = null, preclip = clipAntimeridian, // pre-clip angle\n      x0 = null, y0, x1, y1, postclip = identity, // post-clip extent\n      delta2 = 0.5, // precision\n      projectResample,\n      projectTransform,\n      projectRotateTransform,\n      cache,\n      cacheStream;\n\n  function projection(point) {\n    return projectRotateTransform(point[0] * radians, point[1] * radians);\n  }\n\n  function invert(point) {\n    point = projectRotateTransform.invert(point[0], point[1]);\n    return point && [point[0] * degrees, point[1] * degrees];\n  }\n\n  projection.stream = function(stream) {\n    return cache && cacheStream === stream ? cache : cache = transformRadians(transformRotate(rotate)(preclip(projectResample(postclip(cacheStream = stream)))));\n  };\n\n  projection.preclip = function(_) {\n    return arguments.length ? (preclip = _, theta = undefined, reset()) : preclip;\n  };\n\n  projection.postclip = function(_) {\n    return arguments.length ? (postclip = _, x0 = y0 = x1 = y1 = null, reset()) : postclip;\n  };\n\n  projection.clipAngle = function(_) {\n    return arguments.length ? (preclip = +_ ? clipCircle(theta = _ * radians) : (theta = null, clipAntimeridian), reset()) : theta * degrees;\n  };\n\n  projection.clipExtent = function(_) {\n    return arguments.length ? (postclip = _ == null ? (x0 = y0 = x1 = y1 = null, identity) : clipRectangle(x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1]), reset()) : x0 == null ? null : [[x0, y0], [x1, y1]];\n  };\n\n  projection.scale = function(_) {\n    return arguments.length ? (k = +_, recenter()) : k;\n  };\n\n  projection.translate = function(_) {\n    return arguments.length ? (x = +_[0], y = +_[1], recenter()) : [x, y];\n  };\n\n  projection.center = function(_) {\n    return arguments.length ? (lambda = _[0] % 360 * radians, phi = _[1] % 360 * radians, recenter()) : [lambda * degrees, phi * degrees];\n  };\n\n  projection.rotate = function(_) {\n    return arguments.length ? (deltaLambda = _[0] % 360 * radians, deltaPhi = _[1] % 360 * radians, deltaGamma = _.length > 2 ? _[2] % 360 * radians : 0, recenter()) : [deltaLambda * degrees, deltaPhi * degrees, deltaGamma * degrees];\n  };\n\n  projection.angle = function(_) {\n    return arguments.length ? (alpha = _ % 360 * radians, recenter()) : alpha * degrees;\n  };\n\n  projection.reflectX = function(_) {\n    return arguments.length ? (sx = _ ? -1 : 1, recenter()) : sx < 0;\n  };\n\n  projection.reflectY = function(_) {\n    return arguments.length ? (sy = _ ? -1 : 1, recenter()) : sy < 0;\n  };\n\n  projection.precision = function(_) {\n    return arguments.length ? (projectResample = resample(projectTransform, delta2 = _ * _), reset()) : sqrt(delta2);\n  };\n\n  projection.fitExtent = function(extent, object) {\n    return fitExtent(projection, extent, object);\n  };\n\n  projection.fitSize = function(size, object) {\n    return fitSize(projection, size, object);\n  };\n\n  projection.fitWidth = function(width, object) {\n    return fitWidth(projection, width, object);\n  };\n\n  projection.fitHeight = function(height, object) {\n    return fitHeight(projection, height, object);\n  };\n\n  function recenter() {\n    var center = scaleTranslateRotate(k, 0, 0, sx, sy, alpha).apply(null, project(lambda, phi)),\n        transform = scaleTranslateRotate(k, x - center[0], y - center[1], sx, sy, alpha);\n    rotate = rotateRadians(deltaLambda, deltaPhi, deltaGamma);\n    projectTransform = compose(project, transform);\n    projectRotateTransform = compose(rotate, projectTransform);\n    projectResample = resample(projectTransform, delta2);\n    return reset();\n  }\n\n  function reset() {\n    cache = cacheStream = null;\n    return projection;\n  }\n\n  return function() {\n    project = projectAt.apply(this, arguments);\n    projection.invert = project.invert && invert;\n    return recenter();\n  };\n}\n", "import projection from \"./index.js\";\nimport {abs, epsilon} from \"../math.js\";\n\nexport function naturalEarth1Raw(lambda, phi) {\n  var phi2 = phi * phi, phi4 = phi2 * phi2;\n  return [\n    lambda * (0.8707 - 0.131979 * phi2 + phi4 * (-0.013791 + phi4 * (0.003971 * phi2 - 0.001529 * phi4))),\n    phi * (1.007226 + phi2 * (0.015085 + phi4 * (-0.044475 + 0.028874 * phi2 - 0.005916 * phi4)))\n  ];\n}\n\nnaturalEarth1Raw.invert = function(x, y) {\n  var phi = y, i = 25, delta;\n  do {\n    var phi2 = phi * phi, phi4 = phi2 * phi2;\n    phi -= delta = (phi * (1.007226 + phi2 * (0.015085 + phi4 * (-0.044475 + 0.028874 * phi2 - 0.005916 * phi4))) - y) /\n        (1.007226 + phi2 * (0.015085 * 3 + phi4 * (-0.044475 * 7 + 0.028874 * 9 * phi2 - 0.005916 * 11 * phi4)));\n  } while (abs(delta) > epsilon && --i > 0);\n  return [\n    x / (0.8707 + (phi2 = phi * phi) * (-0.131979 + phi2 * (-0.013791 + phi2 * phi2 * phi2 * (0.003971 - 0.001529 * phi2)))),\n    phi\n  ];\n};\n\nexport default function() {\n  return projection(naturalEarth1Raw)\n      .scale(175.295);\n}\n", "import { geoNaturalEarth1, geoPath } from 'd3-geo';\n\nexport const BASE_MAP_SCALE = 0.19;\nexport const CAMERA_LIMITS = { minZoom: 0.55, maxZoom: 7 };\n\nfunction projectionForCamera(width, height, camera = { x: 0, y: 0, zoom: 1 }) {\n  return geoNaturalEarth1()\n    .translate([width / 2 + camera.x, height / 2 + camera.y])\n    .scale(camera.zoom * Math.min(width, height) * BASE_MAP_SCALE);\n}\n\nfunction projectedSphereBounds(width, height, zoom) {\n  const projection = projectionForCamera(width, height, { x: 0, y: 0, zoom });\n  return geoPath(projection).bounds({ type: 'Sphere' });\n}\n\nfunction minZoomForViewport(width, height) {\n  const [[x0, y0], [x1, y1]] = projectedSphereBounds(width, height, 1);\n  const bw = Math.max(1, x1 - x0);\n  const bh = Math.max(1, y1 - y0);\n  const cover = 0.96;\n  return Math.max(CAMERA_LIMITS.minZoom, (width * cover) / bw, (height * cover) / bh);\n}\n\nexport function clampZoom(zoom, width = 0, height = 0) {\n  const minZoom = width > 0 && height > 0 ? minZoomForViewport(width, height) : CAMERA_LIMITS.minZoom;\n  return Math.max(minZoom, Math.min(CAMERA_LIMITS.maxZoom, zoom));\n}\n\nexport function constrainCamera(camera, width, height) {\n  const zoom = clampZoom(camera.zoom, width, height);\n  const [[left0, top0], [right0, bottom0]] = projectedSphereBounds(width, height, zoom);\n  const bw = right0 - left0;\n  const bh = bottom0 - top0;\n  const padX = Math.min(28, width * 0.04);\n  const padY = Math.min(24, height * 0.04);\n\n  let x = camera.x;\n  let y = camera.y;\n\n  if (bw <= width - padX * 2) {\n    x = 0;\n  } else {\n    const minX = width - padX - right0;\n    const maxX = padX - left0;\n    x = Math.max(minX, Math.min(maxX, x));\n  }\n\n  if (bh <= height - padY * 2) {\n    y = 0;\n  } else {\n    const minY = height - padY - bottom0;\n    const maxY = padY - top0;\n    y = Math.max(minY, Math.min(maxY, y));\n  }\n\n  return { zoom, x, y };\n}\n\nexport function zoomAtPoint(camera, factor, px, py, width, height) {\n  const nextZoom = clampZoom(camera.zoom * factor, width, height);\n  const zf = nextZoom / camera.zoom;\n  const next = {\n    zoom: nextZoom,\n    x: camera.x * zf + (1 - zf) * (px - width / 2),\n    y: camera.y * zf + (1 - zf) * (py - height / 2)\n  };\n  return constrainCamera(next, width, height);\n}\n\nexport function applyCameraTransform(ctx, camera, width, height) {\n  ctx.translate(width / 2 + camera.x, height / 2 + camera.y);\n  ctx.scale(camera.zoom, camera.zoom);\n  ctx.translate(-width / 2, -height / 2);\n}\n\nexport function screenToWorld(camera, x, y, width, height) {\n  return {\n    x: width / 2 + (x - (width / 2 + camera.x)) / camera.zoom,\n    y: height / 2 + (y - (height / 2 + camera.y)) / camera.zoom\n  };\n}\n\nexport function fitCameraToFeature(feature, width, height) {\n  const padding = Math.min(width, height) * 0.16;\n  const baseProjection = projectionForCamera(width, height, { x: 0, y: 0, zoom: 1 });\n  const basePath = geoPath(baseProjection);\n  const [[x0, y0], [x1, y1]] = basePath.bounds(feature);\n  const bw = Math.max(1, x1 - x0);\n  const bh = Math.max(1, y1 - y0);\n  const cx = (x0 + x1) / 2;\n  const cy = (y0 + y1) / 2;\n\n  const targetZoom = clampZoom(Math.min((width - 2 * padding) / bw, (height - 2 * padding) / bh), width, height);\n  const camera = {\n    zoom: targetZoom,\n    x: (width / 2 - cx) * targetZoom,\n    y: (height / 2 - cy) * targetZoom\n  };\n\n  return constrainCamera(camera, width, height);\n}\n", "import { geoNaturalEarth1, geoPath } from 'd3-geo';\nimport { BASE_MAP_SCALE } from './camera.js';\n\nexport function createProjection(width, height) {\n  const projection = geoNaturalEarth1()\n    .translate([width / 2, height / 2])\n    .scale(Math.min(width, height) * BASE_MAP_SCALE);\n  const path = geoPath(projection);\n  return { projection, path };\n}\n", "import { hashString } from '../util/rng.js';\n\nexport function stableCountryColour(cca3, seed) {\n  const h = hashString(`${seed}:${cca3}`) % 360;\n  return `hsl(${h} 42% 44%)`;\n}\n\nexport function heatmapColour(t) {\n  const x = Math.max(0, Math.min(1, t));\n  const hue = 220 - x * 180;\n  return `hsl(${hue} 74% ${38 + x * 18}%)`;\n}\n", "import { screenToWorld } from './camera.js';\n\nconst PICK_GRID_SIZE = 36;\n\nfunction createSpatialIndex(entries) {\n  const cells = new Map();\n\n  for (const entry of entries) {\n    const [[x0, y0], [x1, y1]] = entry.bbox;\n    const minCellX = Math.floor(x0 / PICK_GRID_SIZE);\n    const maxCellX = Math.floor(x1 / PICK_GRID_SIZE);\n    const minCellY = Math.floor(y0 / PICK_GRID_SIZE);\n    const maxCellY = Math.floor(y1 / PICK_GRID_SIZE);\n\n    for (let cellY = minCellY; cellY <= maxCellY; cellY += 1) {\n      for (let cellX = minCellX; cellX <= maxCellX; cellX += 1) {\n        const key = `${cellX}:${cellY}`;\n        const bucket = cells.get(key);\n        if (bucket) bucket.push(entry);\n        else cells.set(key, [entry]);\n      }\n    }\n  }\n\n  return { cells, cellSize: PICK_GRID_SIZE };\n}\n\nfunction getCandidatesFromIndex(index, worldPoint, worldTolerance) {\n  if (!index) return [];\n  const { cells, cellSize } = index;\n  const minCellX = Math.floor((worldPoint.x - worldTolerance) / cellSize);\n  const maxCellX = Math.floor((worldPoint.x + worldTolerance) / cellSize);\n  const minCellY = Math.floor((worldPoint.y - worldTolerance) / cellSize);\n  const maxCellY = Math.floor((worldPoint.y + worldTolerance) / cellSize);\n  const seen = new Set();\n  const candidates = [];\n\n  for (let cellY = minCellY; cellY <= maxCellY; cellY += 1) {\n    for (let cellX = minCellX; cellX <= maxCellX; cellX += 1) {\n      const bucket = cells.get(`${cellX}:${cellY}`);\n      if (!bucket) continue;\n      for (const entry of bucket) {\n        if (seen.has(entry)) continue;\n        seen.add(entry);\n        candidates.push(entry);\n      }\n    }\n  }\n\n  return candidates;\n}\n\nexport function rebuildPickCache(features, path) {\n  const entries = features.map((feature) => {\n    const p = new Path2D(path(feature));\n    const b = path.bounds(feature);\n    return { feature, path2d: p, bbox: b };\n  });\n  entries.spatialIndex = createSpatialIndex(entries);\n  return entries;\n}\n\nexport function pickCountry(ctx, pickCache, camera, width, height, x, y, tolerance = 3) {\n  const worldPoint = screenToWorld(camera, x, y, width, height);\n  const worldTolerance = tolerance / camera.zoom;\n  const indexedCandidates = getCandidatesFromIndex(pickCache.spatialIndex, worldPoint, worldTolerance);\n  const candidates = indexedCandidates.filter((entry) => {\n    const [[x0, y0], [x1, y1]] = entry.bbox;\n    return worldPoint.x >= x0 - worldTolerance\n      && worldPoint.x <= x1 + worldTolerance\n      && worldPoint.y >= y0 - worldTolerance\n      && worldPoint.y <= y1 + worldTolerance;\n  });\n  for (let i = candidates.length - 1; i >= 0; i -= 1) {\n    if (ctx.isPointInPath(candidates[i].path2d, worldPoint.x, worldPoint.y)) {\n      return { cca3: candidates[i].feature.properties.cca3, candidates: candidates.length };\n    }\n  }\n  return { cca3: null, candidates: candidates.length };\n}\n", "import { feature } from 'topojson-client';\nimport { createProjection } from './projection.js';\nimport { heatmapColour, stableCountryColour } from './styles.js';\nimport { rebuildPickCache } from './picking.js';\nimport { applyCameraTransform } from './camera.js';\nimport { selectActiveMetricRange, selectActiveMetricValue } from '../state/metricRange.js';\n\nfunction diplomacyFill(state, cca3) {\n  if (!state.selected) return '#2a3c55';\n  if (cca3 === state.selected) return '#f2c14e';\n  const edge = state.relations?.[state.selected]?.[cca3];\n  if (!edge) return '#1a2433';\n  const rel = edge.rel;\n  if (rel >= 35) return '#2f8f66';\n  if (rel <= -35) return '#a64f4f';\n  return '#6e7787';\n}\n\nfunction relationStroke(state, cca3) {\n  const edge = state.selected ? state.relations?.[state.selected]?.[cca3] : null;\n  if (!edge) return null;\n  const t = edge.tension / 100;\n  const width = 0.7 + t * 2.8;\n  const alpha = 0.15 + t * 0.7;\n  const hue = 125 - t * 125;\n  return { stroke: `hsla(${hue} 85% 60% / ${alpha})`, width };\n}\n\nexport function createRenderer(canvas, topo, getState) {\n  const ctx = canvas.getContext('2d');\n  const dpr = Math.min(window.devicePixelRatio || 1, 1.5);\n  const world = feature(topo, topo.objects.countries);\n  let width = 1;\n  let height = 1;\n  let pickCache = [];\n  let pickByCca3 = {};\n  let geometryKey = '';\n  let spherePath2d = null;\n\n  function resize() {\n    width = canvas.clientWidth;\n    height = canvas.clientHeight;\n    canvas.width = Math.floor(width * dpr);\n    canvas.height = Math.floor(height * dpr);\n    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n  }\n\n  function ensureGeometryCache() {\n    const nextGeometryKey = `${width}:${height}:naturalEarth1`;\n    if (nextGeometryKey === geometryKey && pickCache.length && spherePath2d) return;\n\n    const { path } = createProjection(width, height);\n    pickCache = rebuildPickCache(world.features, path);\n    pickByCca3 = {};\n    for (const entry of pickCache) {\n      pickByCca3[entry.feature.properties.cca3] = entry;\n    }\n    spherePath2d = new Path2D(path({ type: 'Sphere' }));\n    geometryKey = nextGeometryKey;\n  }\n\n  function draw(alpha = 1) {\n    const state = getState();\n    ensureGeometryCache();\n\n    const { min: metricMin, max: metricMax } = selectActiveMetricRange(state);\n\n    ctx.clearRect(0, 0, width, height);\n    ctx.lineJoin = 'round';\n    ctx.lineCap = 'round';\n\n    ctx.save();\n    applyCameraTransform(ctx, state.camera, width, height);\n\n    if (spherePath2d) {\n      ctx.fillStyle = '#0d1828';\n      ctx.globalAlpha = 0.3;\n      ctx.fill(spherePath2d);\n    }\n\n    for (const entry of pickCache) {\n      const { feature: f, path2d } = entry;\n      const cca3 = f.properties.cca3;\n      const value = selectActiveMetricValue(state, cca3);\n      const t = (value - metricMin) / ((metricMax - metricMin) || 1);\n      const fill = state.overlay === 'heatmap'\n        ? heatmapColour(t)\n        : state.overlay === 'diplomacy'\n          ? diplomacyFill(state, cca3)\n          : stableCountryColour(cca3, state.seed);\n      ctx.globalAlpha = alpha;\n      ctx.fillStyle = fill;\n      ctx.fill(path2d);\n      ctx.strokeStyle = '#1a2a3f';\n      ctx.lineWidth = 0.75 / state.camera.zoom;\n      ctx.stroke(path2d);\n\n      if (state.overlay === 'diplomacy' && state.selected) {\n        const border = relationStroke(state, cca3);\n        if (border) {\n          ctx.strokeStyle = border.stroke;\n          ctx.lineWidth = border.width / state.camera.zoom;\n          ctx.stroke(path2d);\n        }\n      }\n    }\n\n    if (spherePath2d) {\n      ctx.save();\n      ctx.setLineDash([]);\n      ctx.globalAlpha = 1;\n      ctx.strokeStyle = 'rgba(166, 202, 244, 0.55)';\n      ctx.lineWidth = 1.4 / state.camera.zoom;\n      ctx.stroke(spherePath2d);\n      ctx.restore();\n    }\n\n    const hover = pickByCca3[state.hovered];\n    if (hover) {\n      ctx.save();\n      ctx.setLineDash([4 / state.camera.zoom, 4 / state.camera.zoom]);\n      ctx.strokeStyle = 'rgba(255,255,255,.8)';\n      ctx.lineWidth = 1.2 / state.camera.zoom;\n      ctx.stroke(hover.path2d);\n      ctx.restore();\n    }\n    const selected = pickByCca3[state.selected];\n    if (selected) {\n      ctx.save();\n      ctx.setLineDash([6 / state.camera.zoom, 4 / state.camera.zoom]);\n      ctx.strokeStyle = '#ffd166';\n      ctx.lineWidth = 2 / state.camera.zoom;\n      ctx.stroke(selected.path2d);\n      ctx.restore();\n    }\n\n    ctx.restore();\n  }\n\n  return { ctx, world, resize, draw, getPickCache: () => pickCache };\n}\n", "export function createFpsCounter() {\n  let last = performance.now();\n  let frames = 0;\n  let fps = 0;\n  return {\n    tick() {\n      frames += 1;\n      const now = performance.now();\n      if (now - last >= 1000) {\n        fps = frames;\n        frames = 0;\n        last = now;\n      }\n      return fps;\n    }\n  };\n}\n", "import { buildLayout } from './ui/layout.js';\nimport { renderTopbar } from './ui/topbar.js';\nimport { wireSearch } from './ui/search.js';\nimport { renderDossier, updateDossierLiveTelemetry } from './ui/dossier.js';\nimport { renderTooltip } from './ui/tooltip.js';\nimport { renderLegend } from './ui/overlays.js';\nimport { renderDebug } from './ui/debug.js';\nimport { makeSnapshot, saveToLocal, loadFromLocal, exportJson, importJsonFile } from './ui/saveLoad.js';\nimport { createStore, createInitialSimState, createInitialRelations, createInitialRelationEffects } from './state/store.js';\nimport { createActions } from './state/actions.js';\nimport { selectActiveMetricRange } from './state/metricRange.js';\nimport { selectNextTurnGainHint } from './state/selectors.js';\nimport { createRenderer } from './map/renderer.js';\nimport { constrainCamera, fitCameraToFeature, zoomAtPoint } from './map/camera.js';\nimport { pickCountry } from './map/picking.js';\nimport { createFpsCounter } from './util/perf.js';\nimport { isTypingTarget } from './util/dom.js';\nimport { getNeighbours } from './state/relationships.js';\n\nconst root = document.getElementById('app');\n\nasync function fetchJsonSafe(url, fallback) {\n  try {\n    const res = await fetch(url);\n    if (!res.ok) return fallback;\n    return await res.json();\n  } catch {\n    return fallback;\n  }\n}\n\nroot.textContent = 'Loading data\u2026';\nconst [countries, topo, neighboursPayload, fullCountries] = await Promise.all([\n  fetchJsonSafe('/api/countries', []),\n  fetchJsonSafe('/api/borders', null),\n  fetchJsonSafe('/api/neighbours', { neighbours: {} }),\n  fetchJsonSafe('/api/countries/full', [])\n]);\nconst countryIndex = Object.fromEntries(fullCountries.filter((c) => c?.cca3).map((c) => [c.cca3, c]));\nif (!topo || !topo.objects?.countries) {\n  root.textContent = 'Failed to load border geometry cache. Run data build and refresh the page.';\n  throw new Error('Missing /api/borders topology payload');\n}\nconst neighbours = neighboursPayload?.neighbours ?? {};\nconst initialRelations = createInitialRelations(1337, neighbours, countryIndex);\n\nroot.innerHTML = '';\nconst ui = buildLayout(root);\nconst store = createStore({\n  seed: 1337,\n  turn: 0,\n  paused: true,\n  speed: 1,\n  hovered: null,\n  selected: null,\n  overlay: 'political',\n  metric: 'gdp',\n  search: '',\n  dossierOpen: false,\n  debug: false,\n  events: [],\n  camera: { x: 0, y: 0, zoom: 1 },\n  countryIndex,\n  neighbours,\n  dynamic: createInitialSimState(countryIndex),\n  relations: initialRelations.relations,\n  relationEdges: initialRelations.edges,\n  postureByCountry: {},\n  relationEffects: createInitialRelationEffects()\n});\nconst actions = createActions(store);\nconst controls = renderTopbar(ui.topbar, actions);\nwireSearch(controls.search, fullCountries, actions);\n\ncontrols.save.onclick = () => saveToLocal(makeSnapshot(store.getState()));\ncontrols.load.onclick = () => { const s = loadFromLocal(); if (s) actions.loadState(s); };\ncontrols.exportBtn.onclick = () => exportJson(makeSnapshot(store.getState()));\ncontrols.importBtn.onclick = async () => { const s = await importJsonFile(); if (s) actions.loadState(s); };\ncontrols.newGame.onclick = () => actions.newGame((Math.random() * 1e9) | 0);\ncontrols.help.onclick = () => showHelp();\n\nconst renderer = createRenderer(ui.canvas, topo, store.getState);\nrenderer.resize();\nactions.setCamera(constrainCamera(store.getState().camera, ui.canvas.clientWidth, ui.canvas.clientHeight));\nlet dirty = true;\nlet mouse = { x: 0, y: 0 };\nlet latestHoverPointer = null;\nlet hoverPickQueued = false;\nlet debugInfo = { fps: 0, candidates: 0, renderMs: 0 };\nconst fpsCounter = createFpsCounter();\n\nlet prevTooltipInputs = null;\nlet prevDossierStructuralInputs = null;\nlet prevDossierTelemetryInputs = null;\nlet prevLegendInputs = null;\nlet prevDebugInputs = null;\n\nfunction getTooltipInputs(state) {\n  const hovered = state.hovered;\n  const country = hovered ? state.countryIndex[hovered] : null;\n  const dyn = hovered ? state.dynamic[hovered] : null;\n  const metricValue = hovered\n    ? state.metric === 'militaryPercentGdp'\n      ? dyn?.militaryPct\n      : state.metric === 'gdp'\n        ? dyn?.gdp\n        : country?.indicators?.[state.metric]\n    : null;\n  return {\n    hovered,\n    x: mouse.x,\n    y: mouse.y,\n    metric: state.metric,\n    metricValue,\n    gdp: dyn?.gdp,\n    population: country?.population\n  };\n}\n\nfunction getDossierStructuralInputs(state) {\n  const selected = state.selected;\n  const dyn = selected ? state.dynamic[selected] : null;\n  const influenceHint = selected ? selectNextTurnGainHint(state, selected) : null;\n  const policy = dyn?.policy;\n  const selectedCooldowns = selected ? JSON.stringify(dyn?.cooldowns ?? {}) : '';\n  const queuedAction = state.queuedPlayerAction\n    ? `${state.queuedPlayerAction.actor}:${state.queuedPlayerAction.target}:${state.queuedPlayerAction.type}`\n    : '';\n  return {\n    selected,\n    dossierOpen: state.dossierOpen,\n    gdp: dyn?.gdp,\n    militaryPct: dyn?.militaryPct,\n    stability: dyn?.stability,\n    influence: dyn?.influence,\n    influenceGainHint: influenceHint?.gain,\n    influenceHintTopGdp: influenceHint?.reasons?.topGdpPercentile,\n    policyMilitaryTarget: policy?.milTargetPct,\n    policyGrowthFocus: policy?.growthFocus,\n    policyStabilityFocus: policy?.stabilityFocus,\n    policyStance: policy?.stance,\n    actionUsedTurn: dyn?.actionUsedTurn,\n    cooldowns: selectedCooldowns,\n    queuedAction,\n    diplomacyTarget: ui.dossier.__diplomacyTarget ?? '',\n    sortMode: ui.dossier.__sortMode ?? 'worst-relationship'\n  };\n}\n\nfunction getDossierTelemetryInputs(state) {\n  const selected = state.selected;\n  const eventSlice = selected\n    ? state.events\n      .filter((e) => e.cca3 === selected || e.secondary === selected)\n      .slice(0, 8)\n      .map((e) => `${e.turn}:${e.text}:${e.secondary ?? ''}`)\n      .join('|')\n    : '';\n  const neighbourSlice = selected\n    ? getNeighbours(selected, state.neighbours)\n      .slice(0, 12)\n      .map((n) => `${n}:${state.relations?.[selected]?.[n]?.rel ?? 0}/${state.relations?.[selected]?.[n]?.tension ?? 0}/${state.relations?.[selected]?.[n]?.trust ?? 50}`)\n      .join('|')\n    : '';\n  return {\n    selected,\n    turn: state.turn,\n    eventSlice,\n    neighbourSlice\n  };\n}\n\nfunction getLegendInputs(state) {\n  const { min, max } = selectActiveMetricRange(state);\n  return {\n    overlay: state.overlay,\n    metric: state.metric,\n    min,\n    max\n  };\n}\n\nfunction getDebugInputs(state) {\n  return {\n    debug: state.debug,\n    fps: debugInfo.fps,\n    turn: state.turn,\n    hovered: state.hovered,\n    candidates: state.debugInfo?.candidates,\n    renderMs: state.debugInfo?.renderMs\n  };\n}\n\nfunction shallowEqual(a, b) {\n  if (a === b) return true;\n  if (!a || !b) return false;\n  const aKeys = Object.keys(a);\n  if (aKeys.length !== Object.keys(b).length) return false;\n  return aKeys.every((k) => a[k] === b[k]);\n}\n\nstore.subscribe(() => { dirty = true; });\nwindow.addEventListener('resize', () => {\n  renderer.resize();\n  actions.setCamera(constrainCamera(store.getState().camera, ui.canvas.clientWidth, ui.canvas.clientHeight));\n  dirty = true;\n});\n\nlet drag = null;\nui.canvas.addEventListener('mousedown', (e) => {\n  drag = { x: e.clientX, y: e.clientY, cam: store.getState().camera };\n  ui.canvas.classList.add('dragging');\n});\nwindow.addEventListener('mouseup', () => { drag = null; ui.canvas.classList.remove('dragging'); });\nwindow.addEventListener('mousemove', (e) => {\n  mouse = { x: e.offsetX, y: e.offsetY };\n  if (drag) {\n    const dx = e.clientX - drag.x; const dy = e.clientY - drag.y;\n    actions.setCamera(constrainCamera({ ...drag.cam, x: drag.cam.x + dx, y: drag.cam.y + dy }, ui.canvas.clientWidth, ui.canvas.clientHeight));\n    return;\n  }\n  latestHoverPointer = { x: e.offsetX, y: e.offsetY };\n  hoverPickQueued = true;\n});\nui.canvas.addEventListener('click', (e) => {\n  const hit = pickCountry(renderer.ctx, renderer.getPickCache(), store.getState().camera, ui.canvas.clientWidth, ui.canvas.clientHeight, e.offsetX, e.offsetY, 6);\n  if (!hit.cca3) return;\n  actions.selectCountry(hit.cca3);\n  const entry = renderer.getPickCache().find((x) => x.feature.properties.cca3 === hit.cca3);\n  if (entry) animateCamera(fitCameraToFeature(entry.feature, ui.canvas.clientWidth, ui.canvas.clientHeight));\n});\nui.canvas.addEventListener('wheel', (e) => {\n  e.preventDefault();\n  const factor = Math.exp(-Math.sign(e.deltaY) * 0.08);\n  actions.setCamera(zoomAtPoint(store.getState().camera, factor, e.offsetX, e.offsetY, ui.canvas.clientWidth, ui.canvas.clientHeight));\n}, { passive: false });\n\nwindow.addEventListener('keydown', (e) => {\n  if (e.key === 'Escape') closeHelp();\n  if (isTypingTarget()) return;\n  if (e.code === 'Space') { e.preventDefault(); actions.togglePause(); }\n  if (e.key === 'ArrowRight') actions.stepTurn();\n  if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'f') { e.preventDefault(); controls.search.focus(); }\n  if (e.key.toLowerCase() === 'd') actions.toggleDebug();\n});\n\nlet acc = 0;\nlet last = performance.now();\nfunction frame(now) {\n  const dt = (now - last) / 1000;\n  last = now;\n  const state = store.getState();\n  if (!state.paused) {\n    acc += dt * state.speed;\n    while (acc >= 1) { actions.stepTurn(); acc -= 1; }\n  }\n  if (hoverPickQueued && latestHoverPointer) {\n    const hit = pickCountry(\n      renderer.ctx,\n      renderer.getPickCache(),\n      state.camera,\n      ui.canvas.clientWidth,\n      ui.canvas.clientHeight,\n      latestHoverPointer.x,\n      latestHoverPointer.y,\n      4\n    );\n    debugInfo.candidates = hit.candidates;\n    actions.setHover(hit.cca3);\n    hoverPickQueued = false;\n  }\n  if (dirty) drawNow();\n  requestAnimationFrame(frame);\n}\nrequestAnimationFrame(frame);\n\nfunction drawNow() {\n  dirty = false;\n  const t0 = performance.now();\n  renderer.draw();\n  debugInfo.fps = fpsCounter.tick();\n  debugInfo.renderMs = performance.now() - t0;\n  const state = store.getState();\n\n  const tooltipInputs = getTooltipInputs(state);\n  if (!shallowEqual(prevTooltipInputs, tooltipInputs)) {\n    renderTooltip(ui.tooltip, state, mouse.x, mouse.y);\n    prevTooltipInputs = tooltipInputs;\n  }\n\n  const dossierStructuralInputs = getDossierStructuralInputs(state);\n  if (!shallowEqual(prevDossierStructuralInputs, dossierStructuralInputs)) {\n    renderDossier(ui.dossier, state, actions, () => {\n      dirty = true;\n    });\n    prevDossierStructuralInputs = dossierStructuralInputs;\n    prevDossierTelemetryInputs = getDossierTelemetryInputs(state);\n  } else {\n    const dossierTelemetryInputs = getDossierTelemetryInputs(state);\n    if (!shallowEqual(prevDossierTelemetryInputs, dossierTelemetryInputs)) {\n      updateDossierLiveTelemetry(ui.dossier, state);\n      prevDossierTelemetryInputs = dossierTelemetryInputs;\n    }\n  }\n\n  const legendInputs = getLegendInputs(state);\n  if (!shallowEqual(prevLegendInputs, legendInputs)) {\n    renderLegend(ui.legend, {\n      ...state,\n      heatNorm(metric, dyn, c) {\n        const v = metric === 'militaryPercentGdp' ? dyn.militaryPct : metric === 'gdp' ? dyn.gdp : c.indicators[metric];\n        const rangeState = metric === state.metric ? state : { ...state, metric };\n        const { min, max } = selectActiveMetricRange(rangeState);\n        return (v - min) / ((max - min) || 1);\n      }\n    });\n    prevLegendInputs = legendInputs;\n  }\n\n  const debugState = { ...state, debugInfo };\n  const debugInputs = getDebugInputs(debugState);\n  if (!shallowEqual(prevDebugInputs, debugInputs)) {\n    renderDebug(ui.debug, debugState);\n    prevDebugInputs = debugInputs;\n  }\n}\n\nfunction animateCamera(target) {\n  const from = store.getState().camera;\n  const t0 = performance.now();\n  const dur = 380;\n  function tick(now) {\n    const p = Math.min(1, (now - t0) / dur);\n    const e = p * (2 - p);\n    actions.setCamera(constrainCamera({ zoom: from.zoom + (target.zoom - from.zoom) * e, x: from.x + (target.x - from.x) * e, y: from.y + (target.y - from.y) * e }, ui.canvas.clientWidth, ui.canvas.clientHeight));\n    if (p < 1) requestAnimationFrame(tick);\n  }\n  requestAnimationFrame(tick);\n}\n\nfunction showHelp() {\n  const modal = document.createElement('div');\n  modal.className = 'modal';\n  modal.id = 'helpModal';\n  modal.innerHTML = '<div class=\"modal-card\"><h2>Help</h2><p>Space pause/unpause \u00B7 Right Arrow step \u00B7 Ctrl+F focus search \u00B7 D debug overlay.</p><button id=\"closeHelp\">Close</button></div>';\n  document.body.append(modal);\n  modal.querySelector('#closeHelp').onclick = () => modal.remove();\n}\nfunction closeHelp() { document.getElementById('helpModal')?.remove(); }\n"],
  "mappings": "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",
  "names": ["root", "actions", "countries", "actions", "neighbours", "countryIndex", "clamp", "link", "neighbours", "actions", "markup", "neighbours", "clamp", "num", "countryIndex", "acc", "clamp", "countryIndex", "neighbours", "num", "countryIndex", "store", "x0", "y0", "o", "arcs", "object", "cartesian", "spherical", "compareIntersection", "n", "sign", "point", "delta", "code", "x0", "y0", "x1", "y1", "x0", "y0", "x1", "y1", "compareIntersection", "ring", "point", "visible", "identity_default", "x0", "y0", "x00", "y00", "x0", "y0", "x00", "y00", "x0", "y0", "append", "projection", "object", "identity_default", "projection", "object", "x0", "y0", "x1", "y1", "x00", "y00", "x0", "y0", "x1", "y1", "identity_default", "projection", "object", "projection", "x0", "y0", "x1", "y1", "feature", "projection", "x0", "y0", "x1", "y1", "feature", "topo", "last"]
}
